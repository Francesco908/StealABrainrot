-- Carica la libreria Fluent
local Fluent = loadstring(game:HttpGet("https://github.com/dawid-scripts/Fluent/releases/latest/download/main.lua"))()
local SaveManager = loadstring(game:HttpGet("https://raw.githubusercontent.com/dawid-scripts/Fluent/master/Addons/SaveManager.lua"))()
local InterfaceManager = loadstring(game:HttpGet("https://raw.githubusercontent.com/dawid-scripts/Fluent/master/Addons/InterfaceManager.lua"))()

-- Crea la finestra principale
local Window = Fluent:CreateWindow({
    Title = "Script Semplice",
    SubTitle = "Test UI",
    TabWidth = 160,
    Size = UDim2.fromOffset(580, 460),
    Acrylic = true,
    Theme = "Dark",
    MinimizeKey = Enum.KeyCode.Z
})

-- Crea l'immagine persistente a destra
local Players = game:GetService("Players")
local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

local persistentGui = Instance.new("ScreenGui")
persistentGui.Name = "FluentPersistentButton"
persistentGui.Parent = playerGui
persistentGui.ResetOnSpawn = false
persistentGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

-- Immagine "fighissima" (sostituisci con il tuo asset ID preferito)
local imageButton = Instance.new("ImageButton")
imageButton.Name = "ZButton"
imageButton.Size = UDim2.fromOffset(80, 80)
imageButton.Position = UDim2.new(1, -100, 0.5, -40) -- Destra al centro
imageButton.AnchorPoint = Vector2.new(1, 0.5)
imageButton.BackgroundColor3 = Color3.fromRGB(30, 30, 45)
imageButton.BorderSizePixel = 0
imageButton.Image = "rbxassetid://11149159963" -- Icona Z (sostituisci con il tuo ID)
imageButton.ScaleType = Enum.ScaleType.Fit
imageButton.Parent = persistentGui

-- Effetti visivi
imageButton.BackgroundTransparency = 0.3
imageButton.ImageTransparency = 0.1

-- Arrotonda gli angoli
local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0.4, 0)
corner.Parent = imageButton

-- Effetto hover
local TweenService = game:GetService("TweenService")
local hoverTween = TweenService:Create(imageButton, TweenInfo.new(0.3), {
    BackgroundTransparency = 0.1,
    ImageTransparency = 0,
    Size = UDim2.fromOffset(85, 85),
    Rotation = 5
})
local normalTween = TweenService:Create(imageButton, TweenInfo.new(0.3), {
    BackgroundTransparency = 0.3,
    ImageTransparency = 0.1,
    Size = UDim2.fromOffset(80, 80),
    Rotation = 0
})

imageButton.MouseEnter:Connect(function()
    hoverTween:Play()
end)
imageButton.MouseLeave:Connect(function()
    normalTween:Play()
end)

-- Funzione per simulare il tasto Z
local function simulateZKey()
    local virtualInput = game:GetService("VirtualInputManager")
    
    -- Simula pressione del tasto Z
    virtualInput:SendKeyEvent(true, Enum.KeyCode.Z, false, game)
    task.wait(0.1)
    virtualInput:SendKeyEvent(false, Enum.KeyCode.Z, false, game)
    
    -- Effetto visivo al click
    local clickTween = TweenService:Create(imageButton, TweenInfo.new(0.15), {
        Size = UDim2.fromOffset(75, 75),
        BackgroundColor3 = Color3.fromRGB(60, 45, 80)
    })
    local releaseTween = TweenService:Create(imageButton, TweenInfo.new(0.15), {
        Size = UDim2.fromOffset(85, 85),
        BackgroundColor3 = Color3.fromRGB(30, 30, 45)
    })
    
    clickTween:Play()
    task.wait(0.15)
    releaseTween:Play()
end

-- Click handler per desktop e mobile
imageButton.MouseButton1Click:Connect(simulateZKey)
imageButton.TouchTap:Connect(simulateZKey)

-- Crea le tab
local Tabs = {
    Main = Window:AddTab({ Title = "Main", Icon = "home" }),
    Settings = Window:AddTab({ Title = "Settings", Icon = "settings" })
}

-- TAB MAIN
Tabs.Main:AddButton({
    Title = "Pulsante Test",
    Description = "Clicca per testare",
    Callback = function()
        Fluent:Notify({
            Title = "Test",
            Content = "Pulsante premuto!",
            Duration = 3
        })
    end
})

-- TAB SETTINGS
Tabs.Settings:AddButton({
    Title = "Pulsante Settings",
    Description = "Pulsante nelle impostazioni",
    Callback = function()
        Fluent:Notify({
            Title = "Settings",
            Content = "Pulsante settings premuto!",
            Duration = 3
        })
    end
})

-- Aggiungi un'etichetta "Z" sotto l'immagine
local zLabel = Instance.new("TextLabel")
zLabel.Name = "ZLabel"
zLabel.Text = "Z"
zLabel.Font = Enum.Font.GothamBold
zLabel.TextSize = 20
zLabel.TextColor3 = Color3.fromRGB(200, 200, 255)
zLabel.BackgroundTransparency = 1
zLabel.Size = UDim2.new(0, 30, 0, 30)
zLabel.Position = UDim2.new(1, -85, 0.5, 45)
zLabel.AnchorPoint = Vector2.new(1, 0.5)
zLabel.Parent = persistentGui

-- Configura i manager
SaveManager:SetLibrary(Fluent)
InterfaceManager:SetLibrary(Fluent)
SaveManager:IgnoreThemeSettings()
InterfaceManager:SetFolder("FluentTest")
SaveManager:SetFolder("FluentTest/config")
InterfaceManager:BuildInterfaceSection(Tabs.Settings)
SaveManager:BuildConfigSection(Tabs.Settings)

-- Seleziona la prima tab
Window:SelectTab(1)

-- Notifica di caricamento con icona Z
Fluent:Notify({
    Title = "Caricato",
    Content = "Premi il pulsante Z a destra!",
    Duration = 5,
    Image = "rbxassetid://7072718162" -- Stessa icona del pulsante
})

-- Carica configurazione automatica
SaveManager:LoadAutoloadConfig()

-- Distruggi la GUI quando lo script viene chiuso
Fluent.Unloaded:Connect(function()
    persistentGui:Destroy()
end)
