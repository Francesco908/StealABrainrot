-- Steal a brainrot Script
-- Advanced Admin GUI with All Features (Fixed Teleport System + Auto Lock)

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")

local player = Players.LocalPlayer
local mouse = player:GetMouse()

-- Variables
local infiniteJumpEnabled = false
local speedHackEnabled = false
local floatEnabled = false
local espEnabled = false
local autoLockEnabled = false   -- aggiunta per auto lock
local autoLockConnection = nil  -- aggiunta per auto lock
local originalWalkSpeed = 16
local floatPosition = nil
local basePosition = nil
local connections = {}
local espObjects = {}
local mobileJumpButton = nil
local mobileJumping = false

-- GUI Creation
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "StealBrainrotScript"
screenGui.ResetOnSpawn = false
screenGui.Parent = player:WaitForChild("PlayerGui")

-- Main Frame
local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Size = UDim2.new(0, 400, 0, 300)
mainFrame.Position = UDim2.new(0.5, -200, 0.5, -150)
mainFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
mainFrame.BorderSizePixel = 0
mainFrame.Active = true
mainFrame.Draggable = true
mainFrame.Parent = screenGui

-- Corner Radius
local mainCorner = Instance.new("UICorner")
mainCorner.CornerRadius = UDim.new(0, 10)
mainCorner.Parent = mainFrame

-- Title Bar
local titleBar = Instance.new("Frame")
titleBar.Name = "TitleBar"
titleBar.Size = UDim2.new(1, 0, 0, 40)
titleBar.Position = UDim2.new(0, 0, 0, 0)
titleBar.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
titleBar.BorderSizePixel = 0
titleBar.Parent = mainFrame

local titleCorner = Instance.new("UICorner")
titleCorner.CornerRadius = UDim.new(0, 10)
titleCorner.Parent = titleBar

-- Title Text
local titleText = Instance.new("TextLabel")
titleText.Name = "TitleText"
titleText.Size = UDim2.new(1, -80, 1, 0)
titleText.Position = UDim2.new(0, 10, 0, 0)
titleText.BackgroundTransparency = 1
titleText.Text = "Steal a brainrot Script"
titleText.TextColor3 = Color3.fromRGB(255, 255, 255)
titleText.TextScaled = true
titleText.Font = Enum.Font.GothamBold
titleText.Parent = titleBar

-- Minimize Button
local minimizeButton = Instance.new("TextButton")
minimizeButton.Name = "MinimizeButton"
minimizeButton.Size = UDim2.new(0, 30, 0, 30)
minimizeButton.Position = UDim2.new(1, -70, 0, 5)
minimizeButton.BackgroundColor3 = Color3.fromRGB(255, 193, 7)
minimizeButton.BorderSizePixel = 0
minimizeButton.Text = "-"
minimizeButton.TextColor3 = Color3.fromRGB(0, 0, 0)
minimizeButton.TextScaled = true
minimizeButton.Font = Enum.Font.GothamBold
minimizeButton.Parent = titleBar

local minimizeCorner = Instance.new("UICorner")
minimizeCorner.CornerRadius = UDim.new(0, 5)
minimizeCorner.Parent = minimizeButton

-- Close Button
local closeButton = Instance.new("TextButton")
closeButton.Name = "CloseButton"
closeButton.Size = UDim2.new(0, 30, 0, 30)
closeButton.Position = UDim2.new(1, -35, 0, 5)
closeButton.BackgroundColor3 = Color3.fromRGB(220, 53, 69)
closeButton.BorderSizePixel = 0
closeButton.Text = "X"
closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
closeButton.TextScaled = true
closeButton.Font = Enum.Font.GothamBold
closeButton.Parent = titleBar

local closeCorner = Instance.new("UICorner")
closeCorner.CornerRadius = UDim.new(0, 5)
closeCorner.Parent = closeButton

-- Tab Buttons Frame
local tabFrame = Instance.new("Frame")
tabFrame.Name = "TabFrame"
tabFrame.Size = UDim2.new(1, 0, 0, 40)
tabFrame.Position = UDim2.new(0, 0, 0, 40)
tabFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
tabFrame.BorderSizePixel = 0
tabFrame.Parent = mainFrame

-- Tab Buttons
local tabButtons = {}
local tabs = {"Main", "Visual", "Misc", "Server"} -- Added "Server" tab

for i, tabName in ipairs(tabs) do
    local tabButton = Instance.new("TextButton")
    tabButton.Name = tabName .. "Tab"
    tabButton.Size = UDim2.new(1/4, -2, 1, -4) -- Changed to 1/4 for 4 tabs
    tabButton.Position = UDim2.new((i-1)/4, 2, 0, 2) -- Changed to 1/4
    tabButton.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
    tabButton.BorderSizePixel = 0
    tabButton.Text = tabName
    tabButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    tabButton.TextScaled = true
    tabButton.Font = Enum.Font.Gotham
    tabButton.Parent = tabFrame

    local tabCorner = Instance.new("UICorner")
    tabCorner.CornerRadius = UDim.new(0, 5)
    tabCorner.Parent = tabButton

    tabButtons[tabName] = tabButton
end

-- Content Frame
local contentFrame = Instance.new("Frame")
contentFrame.Name = "ContentFrame"
contentFrame.Size = UDim2.new(1, 0, 1, -80)
contentFrame.Position = UDim2.new(0, 0, 0, 80)
contentFrame.BackgroundTransparency = 1
contentFrame.Parent = mainFrame

-- Funzione per creare bottoni (con cambio di colore al click)
local function createButton(name, position, parent, callback)
    local button = Instance.new("TextButton")
    button.Name = name
    button.Size = UDim2.new(1, -20, 0, 35)
    button.Position = position
    button.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
    button.BorderSizePixel = 0
    button.Text = name
    button.TextColor3 = Color3.fromRGB(255, 255, 255)
    button.TextScaled = true
    button.Font = Enum.Font.Gotham
    button.Parent = parent

    local buttonCorner = Instance.new("UICorner")
    buttonCorner.CornerRadius = UDim.new(0, 8)
    buttonCorner.Parent = button

    button.MouseButton1Click:Connect(function()
        if callback then
            local state = callback()
            if type(state) == "boolean" then
                if state then
                    button.BackgroundColor3 = Color3.fromRGB(40, 167, 69) -- Verde per "on"
                else
                    button.BackgroundColor3 = Color3.fromRGB(60, 60, 60) -- Normale per "off"
                end
            else
                -- Cambia temporaneamente a verde per pulsanti senza stato
                local originalColor = button.BackgroundColor3
                button.BackgroundColor3 = Color3.fromRGB(40, 167, 69)
                task.wait(0.5)
                button.BackgroundColor3 = originalColor
            end
        end
    end)

    return button
end

-- Tab Content Frames
local tabContents = {}
for _, tabName in ipairs(tabs) do
    local tabContent = Instance.new("Frame")
    tabContent.Name = tabName .. "Content"
    tabContent.Size = UDim2.new(1, 0, 1, 0)
    tabContent.Position = UDim2.new(0, 0, 0, 0)
    tabContent.BackgroundTransparency = 1
    tabContent.Visible = (tabName == "Main")
    tabContent.Parent = contentFrame
    tabContents[tabName] = tabContent
end

-- Main Tab Content
local infiniteJumpButton = createButton("Infinite Jump", UDim2.new(0, 10, 0, 10), tabContents["Main"], function()
    infiniteJumpEnabled = not infiniteJumpEnabled
    -- Update mobile jump button visibility
    if mobileJumpButton then
        mobileJumpButton.Visible = infiniteJumpEnabled
    end
    return infiniteJumpEnabled
end)

local speedHackButton = createButton("Speed Hack", UDim2.new(0, 10, 0, 55), tabContents["Main"], function()
    speedHackEnabled = not speedHackEnabled
    if player.Character and player.Character:FindFirstChild("Humanoid") then
        if speedHackEnabled then
            originalWalkSpeed = player.Character.Humanoid.WalkSpeed
            player.Character.Humanoid.WalkSpeed = originalWalkSpeed * 1.5
        else
            player.Character.Humanoid.WalkSpeed = originalWalkSpeed
        end
    end
    return speedHackEnabled
end)

local floatButton = createButton("Float", UDim2.new(0, 10, 0, 100), tabContents["Main"], function()
    floatEnabled = not floatEnabled
    if floatEnabled then
        createFloatGUI()
    end
    return floatEnabled
end)

local teleportButton = createButton("Teleport", UDim2.new(0, 10, 0, 145), tabContents["Main"], function()
    createTeleportGUI()
    -- Non restituisce nulla
end)

-- *** AUTO LOCK BUTTON ***
local autoLockButton = createButton("Auto Lock", UDim2.new(0, 10, 0, 190), tabContents["Main"], function()
    autoLockEnabled = not autoLockEnabled
    if autoLockEnabled then
        startAutoLock()
    else
        stopAutoLock()
    end
    return autoLockEnabled
end)
-- *** FINE AUTO LOCK BUTTON ***

-- Visual Tab Content
local espButton = createButton("ESP Players", UDim2.new(0, 10, 0, 10), tabContents["Visual"], function()
    espEnabled = not espEnabled
    if espEnabled then
        enableESP()
    else
        disableESP()
    end
    return espEnabled
end)

-- Misc Tab Content
local soonLabel = Instance.new("TextLabel")
soonLabel.Name = "SoonLabel"
soonLabel.Size = UDim2.new(1, -20, 0, 50)
soonLabel.Position = UDim2.new(0, 10, 0, 10)
soonLabel.BackgroundTransparency = 1
soonLabel.Text = "Soon..."
soonLabel.TextColor3 = Color3.fromRGB(150, 150, 150)
soonLabel.TextScaled = true
soonLabel.Font = Enum.Font.GothamBold
soonLabel.Parent = tabContents["Misc"]

-- Server Tab Content
local leaveButton = createButton("Leave Game", UDim2.new(0, 10, 0, 10), tabContents["Server"], function()
    TeleportService:Teleport(0) -- Teleport to home screen
end)

local rejoinButton = createButton("Rejoin Server", UDim2.new(0, 10, 0, 55), tabContents["Server"], function()
    TeleportService:TeleportToPlaceInstance(game.PlaceId, game.JobId, player)
end)

local serverHopButton = createButton("Server Hop", UDim2.new(0, 10, 0, 100), tabContents["Server"], function()
    -- Find a random server to join
    local servers = {}
    local success, result = pcall(function()
        return HttpService:JSONDecode(game:HttpGet("https://games.roblox.com/v1/games/"..game.PlaceId.."/servers/Public?sortOrder=Desc&limit=100"))
    end)
    
    if success and result and result.data then
        for _, server in ipairs(result.data) do
            if server.playing < server.maxPlayers and server.id ~= game.JobId then
                table.insert(servers, server)
            end
        end
        
        if #servers > 0 then
            local randomServer = servers[math.random(1, #servers)]
            TeleportService:TeleportToPlaceInstance(game.PlaceId, randomServer.id, player)
        else
            createNotification("No available servers found!", 2)
        end
    else
        createNotification("Failed to fetch servers", 2)
    end
end)

-- Mobile Jump Button
if UserInputService.TouchEnabled then
    mobileJumpButton = Instance.new("TextButton")
    mobileJumpButton.Name = "MobileJumpButton"
    mobileJumpButton.Size = UDim2.new(0, 100, 0, 50)
    mobileJumpButton.Position = UDim2.new(1, -110, 1, -60)
    mobileJumpButton.BackgroundColor3 = Color3.fromRGB(0, 123, 255)
    mobileJumpButton.BorderSizePixel = 0
    mobileJumpButton.Text = "JUMP"
    mobileJumpButton.TextColor3 = Color3.new(1,1,1)
    mobileJumpButton.TextScaled = true
    mobileJumpButton.Visible = false -- Initially hidden
    mobileJumpButton.Parent = screenGui
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 8)
    corner.Parent = mobileJumpButton
    
    -- Button press events
    mobileJumpButton.MouseButton1Down:Connect(function()
        mobileJumping = true
    end)
    
    mobileJumpButton.MouseButton1Up:Connect(function()
        mobileJumping = false
    end)
    
    mobileJumpButton.MouseLeave:Connect(function()
        mobileJumping = false
    end)
end

-- Float GUI Function
function createFloatGUI()
    local floatGui = Instance.new("Frame")
    floatGui.Name = "FloatGUI"
    floatGui.Size = UDim2.new(0, 200, 0, 120)
    floatGui.Position = UDim2.new(0.5, -100, 0.5, -60)
    floatGui.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
    floatGui.BorderSizePixel = 0
    floatGui.Active = true
    floatGui.Draggable = true
    floatGui.Parent = screenGui

    local floatCorner = Instance.new("UICorner")
    floatCorner.CornerRadius = UDim.new(0, 10)
    floatCorner.Parent = floatGui

    local floatTitle = Instance.new("TextLabel")
    floatTitle.Size = UDim2.new(1, -30, 0, 30)
    floatTitle.Position = UDim2.new(0, 10, 0, 5)
    floatTitle.BackgroundTransparency = 1
    floatTitle.Text = "Float Control"
    floatTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
    floatTitle.TextScaled = true
    floatTitle.Font = Enum.Font.GothamBold
    floatTitle.Parent = floatGui

    local floatCloseButton = Instance.new("TextButton")
    floatCloseButton.Size = UDim2.new(0, 20, 0, 20)
    floatCloseButton.Position = UDim2.new(1, -25, 0, 5)
    floatCloseButton.BackgroundColor3 = Color3.fromRGB(220, 53, 69)
    floatCloseButton.BorderSizePixel = 0
    floatCloseButton.Text = "X"
    floatCloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    floatCloseButton.TextScaled = true
    floatCloseButton.Font = Enum.Font.GothamBold
    floatCloseButton.Parent = floatGui

    local floatCloseCorner = Instance.new("UICorner")
    floatCloseCorner.CornerRadius = UDim.new(0, 5)
    floatCloseCorner.Parent = floatCloseButton

    local upButton = createButton("Up", UDim2.new(0, 10, 0, 40), floatGui, function()
        if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            player.Character.HumanoidRootPart.CFrame = player.Character.HumanoidRootPart.CFrame + Vector3.new(0, 165, 0)
        end
    end)
    upButton.Size = UDim2.new(1, -20, 0, 30)

    local downButton = createButton("Down", UDim2.new(0, 10, 0, 80), floatGui, function()
        if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            player.Character.HumanoidRootPart.CFrame = player.Character.HumanoidRootPart.CFrame - Vector3.new(0, 50, 0)
        end
    end)
    downButton.Size = UDim2.new(1, -20, 0, 30)

    floatCloseButton.MouseButton1Click:Connect(function()
        floatGui:Destroy()
    end)
end

-- Teleport GUI Function
function createTeleportGUI()
    local tpGui = Instance.new("Frame")
    tpGui.Name = "TeleportGUI"
    tpGui.Size = UDim2.new(0, 200, 0, 120)
    tpGui.Position = UDim2.new(0.5, -100, 0.5, -60)
    tpGui.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
    tpGui.BorderSizePixel = 0
    tpGui.Active = true
    tpGui.Draggable = true
    tpGui.Parent = screenGui

    local tpCorner = Instance.new("UICorner")
    tpCorner.CornerRadius = UDim.new(0, 10)
    tpCorner.Parent = tpGui

    local tpTitle = Instance.new("TextLabel")
    tpTitle.Size = UDim2.new(1, -30, 0, 30)
    tpTitle.Position = UDim2.new(0, 10, 0, 5)
    tpTitle.BackgroundTransparency = 1
    tpTitle.Text = "Teleport Control"
    tpTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
    tpTitle.TextScaled = true
    tpTitle.Font = Enum.Font.GothamBold
    tpTitle.Parent = tpGui

    local tpCloseButton = Instance.new("TextButton")
    tpCloseButton.Size = UDim2.new(0, 20, 0, 20)
    tpCloseButton.Position = UDim2.new(1, -25, 0, 5)
    tpCloseButton.BackgroundColor3 = Color3.fromRGB(220, 53, 69)
    tpCloseButton.BorderSizePixel = 0
    tpCloseButton.Text = "X"
    tpCloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    tpCloseButton.TextScaled = true
    tpCloseButton.Font = Enum.Font.GothamBold
    tpCloseButton.Parent = tpGui

    local tpCloseCorner = Instance.new("UICorner")
    tpCloseCorner.CornerRadius = UDim.new(0, 5)
    tpCloseCorner.Parent = tpCloseButton

    local setBaseButton = createButton("Set Base", UDim2.new(0, 10, 0, 40), tpGui, function()
        if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            basePosition = player.Character.HumanoidRootPart.Position
            createNotification("Base position set!", 2)
        else
            createNotification("Character not found!", 2)
        end
    end)

    local tpBaseButton = createButton("TP Base", UDim2.new(0, 10, 0, 80), tpGui, function()
        if basePosition and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            teleportToPosition(basePosition)
        else
            createNotification("Set base position first!", 2)
        end
    end)

    tpCloseButton.MouseButton1Click:Connect(function()
        tpGui:Destroy()
    end)
end

-- ESP Functions
function enableESP()
    for _, otherPlayer in pairs(Players:GetPlayers()) do
        if otherPlayer ~= player and otherPlayer.Character and otherPlayer.Character:FindFirstChild("HumanoidRootPart") then
            createESPForPlayer(otherPlayer)
        end
    end
    connections.playerAdded = Players.PlayerAdded:Connect(function(np)
        np.CharacterAdded:Connect(function(char)
            if espEnabled then task.wait(1); createESPForPlayer(np) end
        end)
    end)
end

function disableESP()
    for _, espObject in pairs(espObjects) do
        if espObject then espObject:Destroy() end
    end
    espObjects = {}
    if connections.playerAdded then connections.playerAdded:Disconnect() end
end

function createESPForPlayer(tp)
    if not (tp.Character and tp.Character:FindFirstChild("HumanoidRootPart")) then return end
    local h = Instance.new("Highlight", tp.Character)
    h.Name = "ESP_" .. tp.Name
    h.FillColor = Color3.fromRGB(0, 162, 255)
    h.OutlineColor = Color3.fromRGB(0, 162, 255)
    h.FillTransparency = 0.5
    h.OutlineTransparency = 0
    espObjects[tp.Name] = h
    tp.Character.AncestryChanged:Connect(function()
        if not tp.Character.Parent then
            if espObjects[tp.Name] then espObjects[tp.Name]:Destroy(); espObjects[tp.Name] = nil end
        end
    end)
end

-- Enhanced Teleport Function with Multiple Bypass Methods
function teleportToPosition(position)
    if not player.Character then 
        createNotification("Character not found!", 2)
        return 
    end
    local rootPart = player.Character:FindFirstChild("HumanoidRootPart")
    if not rootPart then 
        createNotification("HumanoidRootPart not found!", 2)
        return 
    end

    createNotification("Teleporting...", 3)
    
    -- Prendi il controllo della fisica
    local humanoid = player.Character:FindFirstChild("Humanoid")
    if humanoid then
        humanoid.PlatformStand = true
    end
    
    -- Metodo 1: Impostazione diretta
    rootPart.CFrame = CFrame.new(position)
    task.wait(0.1)
    
    -- Metodo 2: Network ownership
    if rootPart:CanSetNetworkOwnership() then
        rootPart:SetNetworkOwner(player)
    end
    rootPart.CFrame = CFrame.new(position)
    task.wait(0.1)
    
    -- Metodo 3: BodyVelocity
    local bv = Instance.new("BodyVelocity")
    bv.Velocity = Vector3.new(0, 0, 0)
    bv.MaxForce = Vector3.new(9e9, 9e9, 9e9)
    bv.P = 9e9
    bv.Parent = rootPart
    rootPart.CFrame = CFrame.new(position)
    task.wait(0.1)
    bv:Destroy()
    
    -- Metodo 4: TweenService per movimento fluido
    local tween = TweenService:Create(rootPart, TweenInfo.new(0.5), {CFrame = CFrame.new(position)})
    tween:Play()
    tween.Completed:Wait()
    
    -- Metodo 5: Impostazione ripetuta
    for i = 1, 5 do
        rootPart.CFrame = CFrame.new(position)
        task.wait()
    end
    
    -- Ripristina fisica
    if humanoid then
        humanoid.PlatformStand = false
    end
    
    createNotification("Teleported successfully!", 2)
end

-- Notification System
function createNotification(text, duration)
    local notifGui = Instance.new("Frame")
    notifGui.Name = "Notification"
    notifGui.Size = UDim2.new(0, 300, 0, 50)
    notifGui.Position = UDim2.new(0.5, -150, 0.1, 0)
    notifGui.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    notifGui.BackgroundTransparency = 0.3
    notifGui.BorderSizePixel = 0
    notifGui.ZIndex = 100
    notifGui.Parent = screenGui
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 12)
    corner.Parent = notifGui
    
    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(1, 0, 1, 0)
    label.BackgroundTransparency = 1
    label.Text = text
    label.TextColor3 = Color3.fromRGB(255, 255, 255)
    label.TextScaled = true
    label.Font = Enum.Font.GothamBold
    label.Parent = notifGui
    
    task.spawn(function()
        for i = 1, duration*10 do
            task.wait(0.1)
        end
        notifGui:Destroy()
    end)
    
    return notifGui
end

-- Infinite Jump Logic (Updated for mobile support)
local function handleInfiniteJump()
    if infiniteJumpEnabled and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
        local shouldJump = UserInputService:IsKeyDown(Enum.KeyCode.Space) or mobileJumping
        
        if shouldJump then
            local root = player.Character.HumanoidRootPart
            local bv = root:FindFirstChild("InfiniteJumpVelocity") or Instance.new("BodyVelocity", root)
            bv.Name = "InfiniteJumpVelocity"
            bv.MaxForce = Vector3.new(0, math.huge, 0)
            bv.Velocity = Vector3.new(0, 50, 0)
            task.wait(0.1)
            if bv then bv:Destroy() end
        end
    else
        local root = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
        if root then
            local bv = root:FindFirstChild("InfiniteJumpVelocity")
            if bv then bv:Destroy() end
        end
    end
end

-- *** AUTO LOCK LOGIC ***
function startAutoLock()
    autoLockEnabled = true
    if autoLockConnection then autoLockConnection:Disconnect() end
    autoLockConnection = RunService.Heartbeat:Connect(function()
        if not autoLockEnabled then return end
        local plotBlock = nil
        -- Cerca tra tutti i PlotBlock sotto Purchases
        for _, purchase in pairs(workspace:GetChildren()) do
            if purchase.Name == "Purchases" then
                for _, block in pairs(purchase:GetChildren()) do
                    if block.Name == "PlotBlock" and block:FindFirstChild("main") then
                        -- Puoi aggiungere qui un filtro per l'ownership se serve
                        plotBlock = block
                        break
                    end
                end
            end
            if plotBlock then break end
        end
        if plotBlock and plotBlock:FindFirstChild("main") then
            local pos = plotBlock.main.Position + Vector3.new(0, 10, 0) -- 10 sopra
            teleportToPosition(pos)
        end
    end)
end

function stopAutoLock()
    autoLockEnabled = false
    if autoLockConnection then
        autoLockConnection:Disconnect()
        autoLockConnection = nil
    end
end
-- *** FINE AUTO LOCK LOGIC ***

-- Tab Switching
for name, btn in pairs(tabButtons) do
    btn.MouseButton1Click:Connect(function()
        for _, c in pairs(tabContents) do c.Visible = false end
        for _, b in pairs(tabButtons) do b.BackgroundColor3 = Color3.fromRGB(45, 45, 45) end
        tabContents[name].Visible = true
        btn.BackgroundColor3 = Color3.fromRGB(0, 123, 255)
    end)
end
tabButtons["Main"].BackgroundColor3 = Color3.fromRGB(0, 123, 255)

-- Minimize/Close Functions
local isMinimized = false
minimizeButton.MouseButton1Click:Connect(function()
    isMinimized = not isMinimized
    if isMinimized then
        TweenService:Create(mainFrame, TweenInfo.new(0.3), {Size = UDim2.new(0, 400, 0, 40)}):Play()
        tabFrame.Visible = false
        contentFrame.Visible = false
        minimizeButton.Text = "+"
    else
        TweenService:Create(mainFrame, TweenInfo.new(0.3), {Size = UDim2.new(0, 400, 0, 300)}):Play()
        tabFrame.Visible = true
        contentFrame.Visible = true
        minimizeButton.Text = "-"
    end
end)

closeButton.MouseButton1Click:Connect(function()
    disableESP()
    stopAutoLock() -- <-- aggiunta per auto lock
    for _, conn in pairs(connections) do if conn then conn:Disconnect() end end
    if mobileJumpButton then mobileJumpButton:Destroy() end
    screenGui:Destroy()
end)

-- Main Loop & Events
connections.heartbeat = RunService.Heartbeat:Connect(handleInfiniteJump)
connections.characterAdded = player.CharacterAdded:Connect(function(char)
    task.wait(1)
    if speedHackEnabled and char:FindFirstChild("Humanoid") then
        originalWalkSpeed = char.Humanoid.WalkSpeed
        char.Humanoid.WalkSpeed = originalWalkSpeed * 1.5
    end
    if espEnabled then task.wait(1); enableESP() end
end)

print("Steal a brainrot Script loaded successfully!")
