-- Steal a brainrot Script v3
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local Mouse = LocalPlayer:GetMouse()
local RunService = game:GetService("RunService")
local Camera = workspace.CurrentCamera

-- Configurazione colori
local COLORS = {
    Background = Color3.fromRGB(15, 15, 20),
    Button = Color3.fromRGB(35, 35, 45),
    ButtonHover = Color3.fromRGB(55, 55, 65),
    ButtonActive = Color3.fromRGB(200, 0, 200),
    Text = Color3.fromRGB(240, 240, 240),
    TabActive = Color3.fromRGB(180, 0, 180),
    Accent = Color3.fromRGB(150, 0, 150)
}

-- Creazione GUI principale
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "StealBrainrotV3"
ScreenGui.Parent = game.CoreGui

local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0, 300, 0, 220)
MainFrame.Position = UDim2.new(0.5, -150, 0.5, -110)
MainFrame.BackgroundColor3 = COLORS.Background
MainFrame.BackgroundTransparency = 0.1
MainFrame.Active = true
MainFrame.Draggable = true
MainFrame.Parent = ScreenGui

-- Cornice stile neomorfico
local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(0, 8)
UICorner.Parent = MainFrame

local UIStroke = Instance.new("UIStroke")
UIStroke.Color = COLORS.Accent
UIStroke.Thickness = 1
UIStroke.Parent = MainFrame

local Title = Instance.new("TextLabel")
Title.Text = "üß† Steal a brainrot v3"
Title.Font = Enum.Font.GothamBold
Title.TextSize = 14
Title.TextColor3 = COLORS.Text
Title.BackgroundTransparency = 1
Title.Size = UDim2.new(1, 0, 0, 25)
Title.Position = UDim2.new(0, 0, 0, 5)
Title.Parent = MainFrame

local Tabs = {"Main", "Visual", "Misc"}
local TabButtons = {}
local TabFrames = {}

-- Creazione pulsanti tab
for i, tabName in ipairs(Tabs) do
    local TabButton = Instance.new("TextButton")
    TabButton.Name = tabName.."Tab"
    TabButton.Size = UDim2.new(0.33, -4, 0, 25)
    TabButton.Position = UDim2.new((i-1)/3, 2, 0, 30)
    TabButton.BackgroundColor3 = COLORS.Button
    TabButton.TextColor3 = COLORS.Text
    TabButton.Text = tabName
    TabButton.Font = Enum.Font.GothamBold
    TabButton.TextSize = 12
    TabButton.Parent = MainFrame
    
    local TabCorner = Instance.new("UICorner")
    TabCorner.CornerRadius = UDim.new(0, 5)
    TabCorner.Parent = TabButton
    
    local TabFrame = Instance.new("Frame")
    TabFrame.Size = UDim2.new(1, -10, 1, -65)
    TabFrame.Position = UDim2.new(0, 5, 0, 60)
    TabFrame.BackgroundTransparency = 1
    TabFrame.Visible = (i == 1)
    TabFrame.Parent = MainFrame
    
    TabButton.MouseButton1Click:Connect(function()
        for _, frame in pairs(TabFrames) do
            frame.Visible = false
        end
        TabFrame.Visible = true
        for _, btn in pairs(TabButtons) do
            btn.BackgroundColor3 = COLORS.Button
        end
        TabButton.BackgroundColor3 = COLORS.TabActive
    end)
    
    TabButtons[tabName] = TabButton
    TabFrames[tabName] = TabFrame
end

-- Funzione per creare pulsanti animati con emoji
local function CreateButton(parent, name, position, callback)
    local Button = Instance.new("TextButton")
    Button.Name = name
    Button.Size = UDim2.new(1, -20, 0, 28)
    Button.Position = position
    Button.BackgroundColor3 = COLORS.Button
    Button.TextColor3 = COLORS.Text
    Button.Text = name
    Button.Font = Enum.Font.Gotham
    Button.TextSize = 12
    Button.Parent = parent
    
    local ButtonCorner = Instance.new("UICorner")
    ButtonCorner.CornerRadius = UDim.new(0, 5)
    ButtonCorner.Parent = Button
    
    local ButtonStroke = Instance.new("UIStroke")
    ButtonStroke.Color = COLORS.Accent
    ButtonStroke.Thickness = 0.8
    ButtonStroke.Parent = Button
    
    local originalColor = Button.BackgroundColor3
    local active = false
    
    Button.MouseEnter:Connect(function()
        if not active then
            Button.BackgroundColor3 = COLORS.ButtonHover
        end
    end)
    
    Button.MouseLeave:Connect(function()
        if not active then
            Button.BackgroundColor3 = originalColor
        end
    end)
    
    Button.MouseButton1Click:Connect(function()
        active = not active
        Button.BackgroundColor3 = active and COLORS.ButtonActive or originalColor
        ButtonStroke.Color = active and Color3.new(1, 1, 1) or COLORS.Accent
        callback(active)
    end)
    
    return Button
end

-- Creazione Steal Helper (GUI speciale)
local StealHelper = Instance.new("Frame")
StealHelper.Name = "StealHelper"
StealHelper.Size = UDim2.new(0, 90, 0, 90)
StealHelper.Position = UDim2.new(0.5, -45, 0.6, 0)
StealHelper.BackgroundColor3 = COLORS.Background
StealHelper.BackgroundTransparency = 0.1
StealHelper.Visible = false
StealHelper.Parent = ScreenGui

local HelperCorner = Instance.new("UICorner")
HelperCorner.CornerRadius = UDim.new(0, 12)
HelperCorner.Parent = StealHelper

local HelperStroke = Instance.new("UIStroke")
HelperStroke.Color = COLORS.Accent
HelperStroke.Thickness = 1
HelperStroke.Parent = StealHelper

local HelperTitle = Instance.new("TextLabel")
HelperTitle.Text = "üïπÔ∏è STEAL HELPER"
HelperTitle.Font = Enum.Font.GothamBold
HelperTitle.TextSize = 12
HelperTitle.TextColor3 = COLORS.Text
HelperTitle.BackgroundTransparency = 1
HelperTitle.Size = UDim2.new(1, 0, 0, 20)
HelperTitle.Position = UDim2.new(0, 0, 0, 5)
HelperTitle.Parent = StealHelper

-- Funzione per muovere il giocatore in altezza
local function MovePlayerY(height)
    if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
        local hrp = LocalPlayer.Character.HumanoidRootPart
        local newPosition = Vector3.new(hrp.Position.X, height, hrp.Position.Z)
        hrp.CFrame = CFrame.new(newPosition)
    end
end

-- Pulsante UP
local UpButton = Instance.new("TextButton")
UpButton.Text = "üîº UP (165)"
UpButton.Font = Enum.Font.GothamBold
UpButton.TextSize = 12
UpButton.Size = UDim2.new(0.8, 0, 0, 25)
UpButton.Position = UDim2.new(0.1, 0, 0.3, 0)
UpButton.BackgroundColor3 = COLORS.Button
UpButton.TextColor3 = COLORS.Text
UpButton.Parent = StealHelper

local UpCorner = Instance.new("UICorner")
UpCorner.CornerRadius = UDim.new(0, 5)
UpCorner.Parent = UpButton

UpButton.MouseButton1Click:Connect(function()
    MovePlayerY(165)
end)

-- Pulsante DOWN
local DownButton = Instance.new("TextButton")
DownButton.Text = "üîΩ DOWN (-50)"
DownButton.Font = Enum.Font.GothamBold
DownButton.TextSize = 12
DownButton.Size = UDim2.new(0.8, 0, 0, 25)
DownButton.Position = UDim2.new(0.1, 0, 0.6, 0)
DownButton.BackgroundColor3 = COLORS.Button
DownButton.TextColor3 = COLORS.Text
DownButton.Parent = StealHelper

local DownCorner = Instance.new("UICorner")
DownCorner.CornerRadius = UDim.new(0, 5)
DownCorner.Parent = DownButton

DownButton.MouseButton1Click:Connect(function()
    MovePlayerY(-50)
end)

-- Rendere lo Steal Helper movibile
local dragging, dragInput, dragStart
StealHelper.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

StealHelper.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end)

game:GetService("UserInputService").InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        local delta = input.Position - dragStart
        StealHelper.Position = UDim2.new(
            0, StealHelper.AbsolutePosition.X + delta.X,
            0, StealHelper.AbsolutePosition.Y + delta.Y
        )
        dragStart = input.Position
    end
end)

--[[
  ========================
  TAB MAIN (con emoji)
  ========================
]]
local MainTab = TabFrames["Main"]

-- Steal Helper Button
CreateButton(MainTab, "üéÆ Steal Helper", UDim2.new(0, 10, 0, 5), function(active)
    StealHelper.Visible = active
end)

-- Anti Ragdoll (Funzionante) üíÄ
CreateButton(MainTab, "üíÄ Anti Ragdoll", UDim2.new(0, 10, 0, 40), function(active)
    if active then
        LocalPlayer.Character.Humanoid:SetStateEnabled(Enum.HumanoidStateType.Ragdoll, false)
    else
        LocalPlayer.Character.Humanoid:SetStateEnabled(Enum.HumanoidStateType.Ragdoll, true)
    end
end)

-- Speed Boost üöÄ
CreateButton(MainTab, "üöÄ Speed Boost", UDim2.new(0, 10, 0, 75), function(active)
    if active then
        LocalPlayer.Character.Humanoid.WalkSpeed = 32
    else
        LocalPlayer.Character.Humanoid.WalkSpeed = 16
    end
end)

-- AntiSteal con KillAura üõ°Ô∏è
local ANTI_STEAL_POSITION = Vector3.new(0, 5, 0)
CreateButton(MainTab, "üõ°Ô∏è AntiSteal", UDim2.new(0, 10, 0, 110), function(active)
    if active then
        local killAuraConn
        killAuraConn = RunService.Heartbeat:Connect(function()
            for _, player in ipairs(Players:GetPlayers()) do
                if player ~= LocalPlayer and player.Character then
                    local hrp = player.Character:FindFirstChild("HumanoidRootPart")
                    if hrp and (hrp.Position - ANTI_STEAL_POSITION).Magnitude < 10 then
                        -- Teletrasporta e uccidi
                        hrp.CFrame = LocalPlayer.Character.HumanoidRootPart.CFrame
                        player.Character.Humanoid.Health = 0
                    end
                end
            end
        end)
    end
end)

-- Anti Trap üß™
CreateButton(MainTab, "üß™ Anti Trap", UDim2.new(0, 10, 0, 145), function(active)
    if active then
        LocalPlayer.Character.Humanoid:SetAttribute("AntiTrap", true)
    else
        LocalPlayer.Character.Humanoid:SetAttribute("AntiTrap", false)
    end
end)

--[[
  ========================
  TAB VISUAL (con emoji)
  ========================
]]
local VisualTab = TabFrames["Visual"]

-- ESP Player con nomi üëÅÔ∏è
local ESPEnabled = false
local ESPCache = {}

-- Funzione avanzata per ESP preciso
local function CreateESP(player)
    if ESPCache[player] then return end
    
    local character = player.Character
    if not character then return end
    
    local ESPHolder = Instance.new("Folder")
    ESPHolder.Name = player.Name.."_ESP"
    ESPHolder.Parent = ScreenGui
    
    -- Box ESP intorno al torso
    local Torso = character:FindFirstChild("HumanoidRootPart") or character:FindFirstChild("Torso")
    if Torso then
        local Box = Instance.new("BoxHandleAdornment")
        Box.Name = "ESPBox"
        Box.Adornee = Torso
        Box.AlwaysOnTop = true
        Box.ZIndex = 10
        Box.Size = Vector3.new(2, 4, 1)
        Box.Transparency = 0.5
        Box.Color3 = Color3.fromRGB(200, 0, 200)
        Box.Parent = ESPHolder
    end
    
    -- Nome sopra la testa
    local Head = character:FindFirstChild("Head")
    if Head then
        local Billboard = Instance.new("BillboardGui")
        Billboard.Name = "ESPName"
        Billboard.Adornee = Head
        Billboard.Size = UDim2.new(0, 100, 0, 40)
        Billboard.StudsOffset = Vector3.new(0, 2.5, 0)
        Billboard.AlwaysOnTop = true
        Billboard.Parent = ESPHolder
        
        local NameLabel = Instance.new("TextLabel")
        NameLabel.Size = UDim2.new(1, 0, 0, 15)
        NameLabel.BackgroundTransparency = 1
        NameLabel.TextColor3 = Color3.new(1, 1, 1)
        NameLabel.Text = player.Name
        NameLabel.Font = Enum.Font.Gotham
        NameLabel.TextSize = 10
        NameLabel.Parent = Billboard
    end
    
    ESPCache[player] = ESPHolder
end

local function UpdateESP()
    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= LocalPlayer then
            if ESPEnabled then
                CreateESP(player)
            elseif ESPCache[player] then
                ESPCache[player]:Destroy()
                ESPCache[player] = nil
            end
        end
    end
end

Players.PlayerAdded:Connect(UpdateESP)
Players.PlayerRemoving:Connect(function(player)
    if ESPCache[player] then
        ESPCache[player]:Destroy()
        ESPCache[player] = nil
    end
end)

CreateButton(VisualTab, "üëÅÔ∏è ESP Player", UDim2.new(0, 10, 0, 5), function(active)
    ESPEnabled = active
    UpdateESP()
end)

-- Inizializzazione
TabButtons["Main"].BackgroundColor3 = COLORS.TabActive
