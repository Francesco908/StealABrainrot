-- Brainrot Universal Script with Advanced Features
-- Multiple Rayfield loading methods
local Rayfield
pcall(function()
    Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()
end)

if not Rayfield then
    pcall(function()
        Rayfield = loadstring(game:HttpGet('https://raw.githubusercontent.com/shlexware/Rayfield/main/source'))()
    end)
end

if not Rayfield then return end

-- Wait for game
repeat wait(0.1) until game:IsLoaded()

-- Services
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local LocalPlayer = Players.LocalPlayer

-- Variables
local basePosition = Vector3.new(0, 10, 0)
local originalSpeed = 16
local godMode = false
local antiRagdoll = false
local autoWalk = false
local skyWidget = nil
local skyWidgetVisible = false

-- Anti-kick system
local function antiKick()
    local mt = getrawmetatable(game)
    local old = mt.__namecall
    setreadonly(mt, false)
    mt.__namecall = newcclosure(function(self, ...)
        local method = getnamecallmethod()
        if method == "Kick" then
            return
        end
        return old(self, ...)
    end)
    setreadonly(mt, true)
end

-- Natural walk teleport (80% speed)
local function naturalWalk(targetPosition)
    local char = LocalPlayer.Character
    if not char or not char:FindFirstChild("HumanoidRootPart") then return end
    
    local hrp = char.HumanoidRootPart
    local humanoid = char.Humanoid
    local startPos = hrp.Position
    local distance = (startPos - targetPosition).Magnitude
    
    -- Calculate time for 80% normal walk speed
    local walkTime = distance / (originalSpeed * 0.8)
    
    -- Create smooth tween
    local tweenInfo = TweenInfo.new(
        walkTime,
        Enum.EasingStyle.Linear,
        Enum.EasingDirection.InOut
    )
    
    local tween = TweenService:Create(hrp, tweenInfo, {CFrame = CFrame.new(targetPosition)})
    tween:Play()
end

-- Teleport Up function
local function teleportUp()
    pcall(function()
        local char = LocalPlayer.Character
        if char and char:FindFirstChild("HumanoidRootPart") then
            local pos = char.HumanoidRootPart.Position
            char.HumanoidRootPart.CFrame = CFrame.new(pos + Vector3.new(0, 350, 0))
        end
    end)
end

-- Teleport Down function
local function teleportDown()
    pcall(function()
        local char = LocalPlayer.Character
        if char and char:FindFirstChild("HumanoidRootPart") then
            local pos = char.HumanoidRootPart.Position
            char.HumanoidRootPart.CFrame = CFrame.new(pos - Vector3.new(0, 50, 0))
        end
    end)
end

-- Create Sky Widget
local function createSkyWidget()
    if skyWidget then
        skyWidget:Destroy()
    end
    
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "SkyWidget"
    screenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")
    skyWidget = screenGui
    
    -- Main Frame
    local mainFrame = Instance.new("Frame")
    mainFrame.Name = "MainFrame"
    mainFrame.Size = UDim2.new(0, 150, 0, 80)
    mainFrame.Position = UDim2.new(0.5, -75, 0.3, -40)
    mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    mainFrame.BorderSizePixel = 0
    mainFrame.Parent = screenGui
    mainFrame.Active = true
    mainFrame.Draggable = true
    
    -- Corner
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 8)
    corner.Parent = mainFrame
    
    -- Close Button
    local closeButton = Instance.new("TextButton")
    closeButton.Name = "CloseButton"
    closeButton.Size = UDim2.new(0, 20, 0, 20)
    closeButton.Position = UDim2.new(1, -25, 0, 5)
    closeButton.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
    closeButton.Text = "X"
    closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    closeButton.TextScaled = true
    closeButton.BorderSizePixel = 0
    closeButton.Parent = mainFrame
    
    local closeCorner = Instance.new("UICorner")
    closeCorner.CornerRadius = UDim.new(0, 4)
    closeCorner.Parent = closeButton
    
    -- Up Button
    local upButton = Instance.new("TextButton")
    upButton.Name = "UpButton"
    upButton.Size = UDim2.new(0, 60, 0, 25)
    upButton.Position = UDim2.new(0, 10, 0, 30)
    upButton.BackgroundColor3 = Color3.fromRGB(50, 150, 50)
    upButton.Text = "UP"
    upButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    upButton.TextScaled = true
    upButton.BorderSizePixel = 0
    upButton.Parent = mainFrame
    
    local upCorner = Instance.new("UICorner")
    upCorner.CornerRadius = UDim.new(0, 4)
    upCorner.Parent = upButton
    
    -- Down Button
    local downButton = Instance.new("TextButton")
    downButton.Name = "DownButton"
    downButton.Size = UDim2.new(0, 60, 0, 25)
    downButton.Position = UDim2.new(0, 80, 0, 30)
    downButton.BackgroundColor3 = Color3.fromRGB(150, 50, 50)
    downButton.Text = "DOWN"
    downButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    downButton.TextScaled = true
    downButton.BorderSizePixel = 0
    downButton.Parent = mainFrame
    
    local downCorner = Instance.new("UICorner")
    downCorner.CornerRadius = UDim.new(0, 4)
    downCorner.Parent = downButton
    
    -- Button connections
    closeButton.MouseButton1Click:Connect(function()
        skyWidget:Destroy()
        skyWidget = nil
        skyWidgetVisible = false
    end)
    
    upButton.MouseButton1Click:Connect(function()
        teleportUp()
    end)
    
    downButton.MouseButton1Click:Connect(function()
        teleportDown()
    end)
    
    skyWidgetVisible = true
end

-- God mode function
local function toggleGodMode()
    godMode = not godMode
    local char = LocalPlayer.Character
    if not char then return end
    
    if godMode then
        for _, part in pairs(char:GetChildren()) do
            if part:IsA("BasePart") then
                part.CanCollide = false
            end
        end
        if char:FindFirstChild("Humanoid") then
            char.Humanoid.MaxHealth = math.huge
            char.Humanoid.Health = math.huge
        end
    else
        for _, part in pairs(char:GetChildren()) do
            if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
                part.CanCollide = true
            end
        end
        if char:FindFirstChild("Humanoid") then
            char.Humanoid.MaxHealth = 100
            char.Humanoid.Health = 100
        end
    end
end

-- Anti-ragdoll function
local function toggleAntiRagdoll()
    antiRagdoll = not antiRagdoll
    local char = LocalPlayer.Character
    if not char then return end
    
    if antiRagdoll then
        for _, part in pairs(char:GetChildren()) do
            if part:IsA("BasePart") then
                part.CustomPhysicalProperties = PhysicalProperties.new(0, 0, 0, 0, 0)
            end
        end
    end
end

-- Auto-set base position
local function updateBase()
    local char = LocalPlayer.Character
    if char and char:FindFirstChild("HumanoidRootPart") then
        basePosition = char.HumanoidRootPart.Position
    end
end

-- Character setup
local function setupCharacter()
    repeat wait(0.1) until LocalPlayer.Character
    repeat wait(0.1) until LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
    updateBase()
end

if LocalPlayer.Character then
    setupCharacter()
end
LocalPlayer.CharacterAdded:Connect(setupCharacter)

-- Initialize anti-kick
pcall(antiKick)

-- Create UI
local Window = Rayfield:CreateWindow({
    Name = "Brainrot Hub",
    LoadingTitle = "Loading...",
    LoadingSubtitle = "Steal a Brainrot script",
    ConfigurationSaving = {Enabled = false},
    Discord = {Enabled = false},
    KeySystem = false
})

local Tab = Window:CreateTab("Main", 4483362458)
local StealTab = Window:CreateTab("Steal/Combat", 4483362458)

-- Speed Section
Tab:CreateSection("Speed & Movement")

Tab:CreateButton({
    Name = "Speed Boost +45%",
    Callback = function()
        pcall(function()
            local char = LocalPlayer.Character
            if char and char:FindFirstChild("Humanoid") then
                char.Humanoid.WalkSpeed = originalSpeed * 1.45
                Rayfield:Notify({
                    Title = "Speed Boost",
                    Content = "Sigma speed activated",
                    Duration = 2,
                    Image = 4483362458
                })
            end
        end)
    end
})

Tab:CreateButton({
    Name = "Natural Walk to Base",
    Callback = function()
        pcall(function()
            naturalWalk(basePosition)
            Rayfield:Notify({
                Title = "Natural Walk",
                Content = "Walking to base naturally...",
                Duration = 2,
                Image = 4483362458
            })
        end)
    end
})

-- Teleport Section
Tab:CreateSection("Teleport")

Tab:CreateInput({
    Name = "Set Base (X,Y,Z)",
    PlaceholderText = "0,10,0",
    RemoveTextAfterFocusLost = false,
    Callback = function(text)
        pcall(function()
            local coords = string.split(text, ",")
            if #coords == 3 then
                local x, y, z = tonumber(coords[1]), tonumber(coords[2]), tonumber(coords[3])
                if x and y and z then
                    basePosition = Vector3.new(x, y, z)
                    Rayfield:Notify({
                        Title = "Base Set",
                        Content = "New base position set",
                        Duration = 2,
                        Image = 4483362458
                    })
                end
            end
        end)
    end
})

Tab:CreateButton({
    Name = "Go Sky",
    Callback = function()
        pcall(function()
            if not skyWidgetVisible then
                createSkyWidget()
                Rayfield:Notify({
                    Title = "Sky Widget",
                    Content = "Sky teleport widget opened",
                    Duration = 2,
                    Image = 4483362458
                })
            end
        end)
    end
})

-- Steal/Combat Features
StealTab:CreateSection("Combat & Steal")

StealTab:CreateButton({
    Name = "Toggle God Mode",
    Callback = function()
        pcall(function()
            toggleGodMode()
            Rayfield:Notify({
                Title = "God Mode",
                Content = godMode and "God Mode ON" or "God Mode OFF",
                Duration = 2,
                Image = 4483362458
            })
        end)
    end
})

StealTab:CreateButton({
    Name = "Toggle Anti-Ragdoll",
    Callback = function()
        pcall(function()
            toggleAntiRagdoll()
            Rayfield:Notify({
                Title = "Anti-Ragdoll",
                Content = antiRagdoll and "Anti-Ragdoll ON" or "Anti-Ragdoll OFF",
                Duration = 2,
                Image = 4483362458
            })
        end)
    end
})

StealTab:CreateButton({
    Name = "Invisibility Toggle",
    Callback = function()
        pcall(function()
            local char = LocalPlayer.Character
            if char then
                for _, part in pairs(char:GetChildren()) do
                    if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
                        part.Transparency = part.Transparency == 0 and 1 or 0
                    end
                end
            end
        end)
    end
})

StealTab:CreateButton({
    Name = "No Clip Toggle",
    Callback = function()
        pcall(function()
            local char = LocalPlayer.Character
            if char then
                for _, part in pairs(char:GetChildren()) do
                    if part:IsA("BasePart") then
                        part.CanCollide = not part.CanCollide
                    end
                end
            end
        end)
    end
})

StealTab:CreateButton({
    Name = "Steal All Items (Radius)",
    Callback = function()
        pcall(function()
            local char = LocalPlayer.Character
            if char and char:FindFirstChild("HumanoidRootPart") then
                local hrp = char.HumanoidRootPart
                for _, obj in pairs(workspace:GetChildren()) do
                    if obj:IsA("Tool") or obj:IsA("Model") then
                        local distance = (obj.Position - hrp.Position).Magnitude
                        if distance < 100 then
                            obj.Parent = LocalPlayer.Backpack
                        end
                    end
                end
            end
        end)
    end
})

StealTab:CreateButton({
    Name = "Infinite Jump",
    Callback = function()
        pcall(function()
            local char = LocalPlayer.Character
            if char and char:FindFirstChild("Humanoid") then
                char.Humanoid.JumpPower = 100
                UserInputService.JumpRequest:Connect(function()
                    if char and char:FindFirstChild("Humanoid") then
                        char.Humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
                    end
                end)
            end
        end)
    end
})

StealTab:CreateButton({
    Name = "Fly Mode",
    Callback = function()
        pcall(function()
            local char = LocalPlayer.Character
            if char and char:FindFirstChild("HumanoidRootPart") then
                local hrp = char.HumanoidRootPart
                local bodyVelocity = Instance.new("BodyVelocity")
                bodyVelocity.MaxForce = Vector3.new(4000, 4000, 4000)
                bodyVelocity.Velocity = Vector3.new(0, 0, 0)
                bodyVelocity.Parent = hrp
                
                local flying = true
                UserInputService.InputBegan:Connect(function(input)
                    if input.KeyCode == Enum.KeyCode.Space then
                        bodyVelocity.Velocity = Vector3.new(0, 50, 0)
                    end
                end)
            end
        end)
    end
})

StealTab:CreateButton({
    Name = "Speed Steal Mode",
    Callback = function()
        pcall(function()
            local char = LocalPlayer.Character
            if char and char:FindFirstChild("Humanoid") then
                char.Humanoid.WalkSpeed = 100
                -- Auto collect items while moving
                spawn(function()
                    while char.Parent do
                        for _, obj in pairs(workspace:GetChildren()) do
                            if obj:IsA("Tool") then
                                obj.Parent = LocalPlayer.Backpack
                            end
                        end
                        wait(0.1)
                    end
                end)
            end
        end)
    end
})

StealTab:CreateButton({
    Name = "Teleport to All Players",
    Callback = function()
        pcall(function()
            for _, player in pairs(Players:GetPlayers()) do
                if player ~= LocalPlayer and player.Character then
                    local char = LocalPlayer.Character
                    if char and char:FindFirstChild("HumanoidRootPart") then
                        char.HumanoidRootPart.CFrame = player.Character.HumanoidRootPart.CFrame
                        wait(0.5)
                    end
                end
            end
        end)
    end
})

StealTab:CreateButton({
    Name = "Anti-Kill Aura",
    Callback = function()
        pcall(function()
            local char = LocalPlayer.Character
            if char then
                local shield = Instance.new("ForceField")
                shield.Parent = char
                
                spawn(function()
                    while char.Parent do
                        for _, player in pairs(Players:GetPlayers()) do
                            if player ~= LocalPlayer and player.Character then
                                local distance = (player.Character.HumanoidRootPart.Position - char.HumanoidRootPart.Position).Magnitude
                                if distance < 20 then
                                    player.Character.HumanoidRootPart.CFrame = player.Character.HumanoidRootPart.CFrame + Vector3.new(0, 50, 0)
                                end
                            end
                        end
                        wait(0.1)
                    end
                end)
            end
        end)
    end
})

-- Success notification
Rayfield:Notify({
    Title = "Brainrot Hub Loaded",
    Content = "Sigma grindset activated!",
    Duration = 3,
    Image = 4483362458
})
