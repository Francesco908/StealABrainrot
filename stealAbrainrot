-- Brainrot Universal Script with Enhanced Features
-- Multiple Rayfield loading methods
local Rayfield
pcall(function()
    Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()
end)

if not Rayfield then
    pcall(function()
        Rayfield = loadstring(game:HttpGet('https://raw.githubusercontent.com/shlexware/Rayfield/main/source'))()
    end)
end

if not Rayfield then return end

-- Wait for game
repeat task.wait(0.1) until game:IsLoaded()

-- Services
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local TeleportService = game:GetService("TeleportService")
local Workspace = game:GetService("Workspace")
local ProximityPromptService = game:GetService("ProximityPromptService")
local LocalPlayer = Players.LocalPlayer

-- Variables
local basePosition = Vector3.new(0, 10, 0)
local originalSpeed = 16
local godMode = false
local antiRagdoll = false
local autoWalk = false
local skyWidget = nil
local skyWidgetVisible = false
local skyWidgetMinimized = false
local leaveGui = nil
local killAuraActive = false
local killAuraConnection = nil
local intentionalKick = false
local flyEnabled = false
local flyConnection = nil
local espEnabled = false
local espObjects = {}
local boostGui = nil
local boostActive = false
local fastStealEnabled = false
local fastStealConnection = nil
local autoCollectMoneyEnabled = false
local autoCollectConnection = nil

-- Anti-kick system
local function antiKick()
    local mt = getrawmetatable(game)
    if not mt then return end
    
    local old = mt.__namecall
    setreadonly(mt, false)
    
    mt.__namecall = newcclosure(function(self, ...)
        local method = getnamecallmethod()
        if method == "Kick" and not intentionalKick then
            return
        end
        return old(self, ...)
    end)
    
    setreadonly(mt, true)
end

-- Sistema Fast Steal avanzato con targeting intelligente
local function getClosestStealable()
    local character = LocalPlayer.Character
    if not character then return nil end
    
    local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
    if not humanoidRootPart then return nil end

    local closestObject = nil
    local closestDistance = math.huge
    local maxStealDistance = 25

    -- Cerca nella workspace
    for _, obj in ipairs(Workspace:GetDescendants()) do
        if obj:IsA("ProximityPrompt") and obj.Enabled then
            local parent = obj.Parent
            if parent and parent:IsA("BasePart") then
                local distance = (humanoidRootPart.Position - parent.Position).Magnitude
                if distance <= maxStealDistance and distance < closestDistance then
                    closestObject = obj
                    closestDistance = distance
                end
            end
        end
    end

    -- Cerca nei personaggi dei giocatori
    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= LocalPlayer then
            local character = player.Character
            if character then
                for _, obj in ipairs(character:GetDescendants()) do
                    if obj:IsA("ProximityPrompt") and obj.Enabled then
                        local parent = obj.Parent
                        if parent and parent:IsA("BasePart") then
                            local distance = (humanoidRootPart.Position - parent.Position).Magnitude
                            if distance <= maxStealDistance and distance < closestDistance then
                                closestObject = obj
                                closestDistance = distance
                            end
                        end
                    end
                end
            end
        end
    end

    return closestObject
end

local function setupFastSteal()
    if fastStealConnection then
        fastStealConnection:Disconnect()
        fastStealConnection = nil
    end
    
    fastStealConnection = RunService.Heartbeat:Connect(function()
        pcall(function()
            local closestPrompt = getClosestStealable()
            if closestPrompt then
                -- Imposta il tempo di hold a 0.5 secondi
                local originalHoldDuration = closestPrompt.HoldDuration
                closestPrompt.HoldDuration = 0.5
                
                -- Attiva il prompt
                fireproximityprompt(closestPrompt)
                
                -- Ripristina il valore originale
                closestPrompt.HoldDuration = originalHoldDuration
                
                -- Breve pausa per evitare spam
                task.wait(0.1)
            end
        end)
    end)
end

-- Auto Collect Money system
local function setupAutoCollectMoney()
    if autoCollectConnection then
        autoCollectConnection:Disconnect()
        autoCollectConnection = nil
    end
    
    autoCollectConnection = RunService.Heartbeat:Connect(function()
        pcall(function()
            -- Find and collect money
            for _, obj in ipairs(Workspace:GetDescendants()) do
                if obj.Name:lower():find("money") or obj.Name:lower():find("cash") or obj.Name:lower():find("coin") then
                    if obj:IsA("BasePart") then
                        local prompt = obj:FindFirstChildWhichIsA("ProximityPrompt")
                        if prompt then
                            fireproximityprompt(prompt)
                            task.wait(0.05)
                        end
                    end
                end
            end
        end)
    end)
end

-- Remove Walls function
local function removeWalls()
    pcall(function()
        -- Remove lasers
        for _, obj in pairs(Workspace:GetDescendants()) do
            if obj.Name:lower():find("laser") or obj.Name:lower():find("laserhitbox") then
                obj:Destroy()
            end
        end
        
        Rayfield:Notify({
            Title = "Walls Removed",
            Content = "All lasers and hitboxes deleted!",
            Duration = 3,
            Image = 4483362458
        })
    end)
end

-- Enhanced God Mode with anti-ragdoll
local function setGodMode(state)
    godMode = state
    local char = LocalPlayer.Character
    if not char then return end
    
    if godMode then
        for _, part in pairs(char:GetChildren()) do
            if part:IsA("BasePart") then
                part.CanCollide = false
                part.CustomPhysicalProperties = PhysicalProperties.new(0, 0, 0, 0, 0)
            end
        end
        
        local humanoid = char:FindFirstChild("Humanoid")
        if humanoid then
            humanoid.MaxHealth = math.huge
            humanoid.Health = math.huge
            
            -- Anti-ragdoll
            humanoid:SetStateEnabled(Enum.HumanoidStateType.FallingDown, false)
            humanoid:SetStateEnabled(Enum.HumanoidStateType.Ragdoll, false)
            humanoid:SetStateEnabled(Enum.HumanoidStateType.PlatformStanding, false)
            
            humanoid.StateChanged:Connect(function(_, newState)
                if newState == Enum.HumanoidStateType.FallingDown or 
                   newState == Enum.HumanoidStateType.Ragdoll then
                    humanoid:ChangeState(Enum.HumanoidStateType.GettingUp)
                end
            end)
        end
    else
        for _, part in pairs(char:GetChildren()) do
            if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
                part.CanCollide = true
                part.CustomPhysicalProperties = nil
            end
        end
        
        local humanoid = char:FindFirstChild("Humanoid")
        if humanoid then
            humanoid.MaxHealth = 100
            humanoid.Health = 100
            
            -- Re-enable states
            humanoid:SetStateEnabled(Enum.HumanoidStateType.FallingDown, true)
            humanoid:SetStateEnabled(Enum.HumanoidStateType.Ragdoll, true)
            humanoid:SetStateEnabled(Enum.HumanoidStateType.PlatformStanding, true)
        end
    end
end

-- ESP Functions
local function createESP(player)
    if not player or not player:IsA("Player") then return end
    local char = player.Character
    if not char then return end
    
    -- Clean up existing ESP first
    removeESP(player)
    
    local highlight = Instance.new("Highlight")
    highlight.Name = "ESP_" .. player.Name
    highlight.Adornee = char
    highlight.OutlineColor = player == LocalPlayer and Color3.new(0, 1, 0) or Color3.new(1, 0, 0)
    highlight.FillTransparency = 1
    highlight.OutlineTransparency = 0
    highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
    highlight.Parent = char
    
    espObjects[player] = highlight
    
    -- Find suitable part for billboard
    local billboardAdornee = char:FindFirstChild("Head") or char:FindFirstChild("HumanoidRootPart")
    if billboardAdornee then
        local billboard = Instance.new("BillboardGui")
        billboard.Name = "ESPTag"
        billboard.Adornee = billboardAdornee
        billboard.Size = UDim2.new(0, 200, 0, 50)
        billboard.StudsOffset = Vector3.new(0, 3, 0)
        billboard.AlwaysOnTop = true
        billboard.Parent = billboardAdornee
        
        local label = Instance.new("TextLabel")
        label.Size = UDim2.new(1, 0, 1, 0)
        label.BackgroundTransparency = 1
        label.Text = player.Name
        label.TextColor3 = player == LocalPlayer and Color3.new(0, 1, 0) or Color3.new(1, 0, 0)
        label.TextSize = 14
        label.Font = Enum.Font.GothamBold
        label.Parent = billboard
    end
end

local function removeESP(player)
    if not player then return end
    
    if espObjects[player] then
        espObjects[player]:Destroy()
        espObjects[player] = nil
    end
    
    if player.Character then
        for _, descendant in pairs(player.Character:GetDescendants()) do
            if descendant.Name == "ESPTag" then
                descendant:Destroy()
            end
        end
    end
end

local function toggleESP()
    espEnabled = not espEnabled
    
    if espEnabled then
        for _, player in pairs(Players:GetPlayers()) do
            createESP(player)
        end
        
        Players.PlayerAdded:Connect(function(player)
            player.CharacterAdded:Connect(function()
                if espEnabled then
                    createESP(player)
                end
            end)
        end)
        
        Players.PlayerRemoving:Connect(function(player)
            removeESP(player)
        end)
    else
        for player, _ in pairs(espObjects) do
            removeESP(player)
        end
    end
end

-- Teleport Up function
local function teleportUp()
    pcall(function()
        local char = LocalPlayer.Character
        if char and char:FindFirstChild("HumanoidRootPart") then
            local pos = char.HumanoidRootPart.Position
            char.HumanoidRootPart.CFrame = CFrame.new(pos + Vector3.new(0, 265, 0))
        end
    end)
end

-- Teleport Down function
local function teleportDown()
    pcall(function()
        local char = LocalPlayer.Character
        if char and char:FindFirstChild("HumanoidRootPart") then
            local pos = char.HumanoidRootPart.Position
            char.HumanoidRootPart.CFrame = CFrame.new(pos - Vector3.new(0, 50, 0))
        end
    end)
end

-- Teleport to Base (high above)
local function teleportToBase()
    pcall(function()
        local char = LocalPlayer.Character
        if char and char:FindFirstChild("HumanoidRootPart") then
            local targetPos = basePosition + Vector3.new(0, 265, 0)
            char.HumanoidRootPart.CFrame = CFrame.new(targetPos)
            
            Rayfield:Notify({
                Title = "Base Teleport",
                Content = "Teleported above base! Use DOWN to land.",
                Duration = 2,
                Image = 4483362458
            })
        end
    end)
end

-- Enhanced Kill Aura with 360-degree detection
local function startKillAura()
    if killAuraActive then return end
    killAuraActive = true
    
    killAuraConnection = RunService.Heartbeat:Connect(function()
        pcall(function()
            local char = LocalPlayer.Character
            if not char or not char:FindFirstChild("HumanoidRootPart") then return end
            
            local tool = LocalPlayer.Backpack:FindFirstChildOfClass("Tool") or char:FindFirstChildOfClass("Tool")
            if not tool then return end
            
            local nearbyPlayers = {}
            
            -- Find all nearby players
            for _, player in pairs(Players:GetPlayers()) do
                if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                    local distance = (player.Character.HumanoidRootPart.Position - char.HumanoidRootPart.Position).Magnitude
                    if distance < 20 then
                        table.insert(nearbyPlayers, {player = player, distance = distance})
                    end
                end
            end
            
            -- Sort by distance
            table.sort(nearbyPlayers, function(a, b)
                return a.distance < b.distance
            end)
            
            -- Attack closest players
            for i = 1, math.min(#nearbyPlayers, 3) do
                local targetPlayer = nearbyPlayers[i].player
                local targetChar = targetPlayer.Character
                
                if targetChar and targetChar:FindFirstChild("HumanoidRootPart") then
                    local targetDirection = (targetChar.HumanoidRootPart.Position - char.HumanoidRootPart.Position).Unit
                    local lookDirection = Vector3.new(targetDirection.X, 0, targetDirection.Z)
                    char.HumanoidRootPart.CFrame = CFrame.lookAt(char.HumanoidRootPart.Position, char.HumanoidRootPart.Position + lookDirection)
                    
                    if tool.Parent == LocalPlayer.Backpack then
                        char.Humanoid:EquipTool(tool)
                    end
                    
                    if tool:FindFirstChild("Handle") then
                        tool:Activate()
                    end
                    
                    task.wait(0.05)
                end
            end
        end)
    end)
end

local function stopKillAura()
    if killAuraConnection then
        killAuraConnection:Disconnect()
        killAuraConnection = nil
    end
    killAuraActive = false
end

-- Create Leave GUI
local function createLeaveGui()
    if leaveGui then
        leaveGui:Destroy()
    end
    
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "LeaveGui"
    screenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")
    screenGui.ResetOnSpawn = false
    leaveGui = screenGui
    
    -- Main Frame
    local mainFrame = Instance.new("Frame")
    mainFrame.Name = "MainFrame"
    mainFrame.Size = UDim2.new(0, 200, 0, 150)
    mainFrame.Position = UDim2.new(0.5, -100, 0.5, -75)
    mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 45)
    mainFrame.BackgroundTransparency = 0.1
    mainFrame.BorderSizePixel = 0
    mainFrame.Parent = screenGui
    mainFrame.Active = true
    mainFrame.Draggable = true
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 12)
    corner.Parent = mainFrame
    
    -- Header
    local header = Instance.new("Frame")
    header.Name = "Header"
    header.Size = UDim2.new(1, 0, 0, 30)
    header.Position = UDim2.new(0, 0, 0, 0)
    header.BackgroundColor3 = Color3.fromRGB(50, 20, 30)
    header.BackgroundTransparency = 0.2
    header.BorderSizePixel = 0
    header.Parent = mainFrame
    
    local headerCorner = Instance.new("UICorner")
    headerCorner.CornerRadius = UDim.new(0, 12)
    headerCorner.Parent = header
    
    -- Title
    local title = Instance.new("TextLabel")
    title.Name = "Title"
    title.Size = UDim2.new(1, -60, 1, 0)
    title.Position = UDim2.new(0, 10, 0, 0)
    title.BackgroundTransparency = 1
    title.Text = "SERVER OPTIONS"
    title.TextColor3 = Color3.fromRGB(255, 255, 255)
    title.TextSize = 14
    title.Font = Enum.Font.GothamBold
    title.Parent = header
    
    -- Minimize Button
    local minimizeButton = Instance.new("TextButton")
    minimizeButton.Name = "MinimizeButton"
    minimizeButton.Size = UDim2.new(0, 20, 0, 20)
    minimizeButton.Position = UDim2.new(1, -50, 0.5, -10)
    minimizeButton.BackgroundColor3 = Color3.fromRGB(255, 180, 40)
    minimizeButton.Text = "-"
    minimizeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    minimizeButton.TextSize = 14
    minimizeButton.Font = Enum.Font.GothamBold
    minimizeButton.BorderSizePixel = 0
    minimizeButton.Parent = header
    
    local minimizeCorner = Instance.new("UICorner")
    minimizeCorner.CornerRadius = UDim.new(0, 10)
    minimizeCorner.Parent = minimizeButton
    
    -- Close Button
    local closeButton = Instance.new("TextButton")
    closeButton.Name = "CloseButton"
    closeButton.Size = UDim2.new(0, 20, 0, 20)
    closeButton.Position = UDim2.new(1, -25, 0.5, -10)
    closeButton.BackgroundColor3 = Color3.fromRGB(220, 60, 60)
    closeButton.Text = "âœ•"
    closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    closeButton.TextSize = 14
    closeButton.Font = Enum.Font.GothamBold
    closeButton.BorderSizePixel = 0
    closeButton.Parent = header
    
    local closeCorner = Instance.new("UICorner")
    closeCorner.CornerRadius = UDim.new(0, 10)
    closeCorner.Parent = closeButton
    
    -- Content Frame
    local contentFrame = Instance.new("Frame")
    contentFrame.Name = "ContentFrame"
    contentFrame.Size = UDim2.new(1, 0, 1, -30)
    contentFrame.Position = UDim2.new(0, 0, 0, 30)
    contentFrame.BackgroundTransparency = 1
    contentFrame.Parent = mainFrame
    
    -- Leave Button
    local leaveButton = Instance.new("TextButton")
    leaveButton.Name = "LeaveButton"
    leaveButton.Size = UDim2.new(0, 180, 0, 30)
    leaveButton.Position = UDim2.new(0.5, -90, 0, 20)
    leaveButton.BackgroundColor3 = Color3.fromRGB(200, 70, 70)
    leaveButton.Text = "ðŸšª LEAVE GAME"
    leaveButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    leaveButton.TextSize = 14
    leaveButton.Font = Enum.Font.GothamBold
    leaveButton.BorderSizePixel = 0
    leaveButton.Parent = contentFrame
    
    local leaveCorner = Instance.new("UICorner")
    leaveCorner.CornerRadius = UDim.new(0, 8)
    leaveCorner.Parent = leaveButton
    
    -- Server Hop Button
    local hopButton = Instance.new("TextButton")
    hopButton.Name = "HopButton"
    hopButton.Size = UDim2.new(0, 180, 0, 30)
    hopButton.Position = UDim2.new(0.5, -90, 0, 60)
    hopButton.BackgroundColor3 = Color3.fromRGB(70, 120, 200)
    hopButton.Text = "ðŸ”„ SERVER HOP"
    hopButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    hopButton.TextSize = 14
    hopButton.Font = Enum.Font.GothamBold
    hopButton.BorderSizePixel = 0
    hopButton.Parent = contentFrame
    
    local hopCorner = Instance.new("UICorner")
    hopCorner.CornerRadius = UDim.new(0, 8)
    hopCorner.Parent = hopButton
    
    -- Minimize functionality
    local function toggleMinimize()
        contentFrame.Visible = not contentFrame.Visible
        mainFrame.Size = UDim2.new(0, 200, contentFrame.Visible and 150 or 30)
        minimizeButton.Text = contentFrame.Visible and "-" or "+"
    end
    
    -- Button connections
    minimizeButton.MouseButton1Click:Connect(toggleMinimize)
    
    closeButton.MouseButton1Click:Connect(function()
        leaveGui:Destroy()
        leaveGui = nil
    end)
    
    leaveButton.MouseButton1Click:Connect(function()
        intentionalKick = true
        LocalPlayer:Kick("Left the game")
    end)
    
    hopButton.MouseButton1Click:Connect(function()
        TeleportService:Teleport(game.PlaceId, LocalPlayer)
    end)
end

-- Create Sky Widget with TP to Base button
local function createSkyWidget()
    if skyWidget then
        skyWidget:Destroy()
    end
    
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "SkyWidget"
    screenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")
    screenGui.ResetOnSpawn = false
    skyWidget = screenGui
    
    -- Main Frame
    local mainFrame = Instance.new("Frame")
    mainFrame.Name = "MainFrame"
    mainFrame.Size = UDim2.new(0, 180, 0, 190)
    mainFrame.Position = UDim2.new(0.5, -90, 0.3, -95)
    mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 45)
    mainFrame.BackgroundTransparency = 0.1
    mainFrame.BorderSizePixel = 0
    mainFrame.Parent = screenGui
    mainFrame.Active = true
    mainFrame.Draggable = true
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 12)
    corner.Parent = mainFrame
    
    -- Header
    local header = Instance.new("Frame")
    header.Name = "Header"
    header.Size = UDim2.new(1, 0, 0, 30)
    header.Position = UDim2.new(0, 0, 0, 0)
    header.BackgroundColor3 = Color3.fromRGB(45, 30, 60)
    header.BackgroundTransparency = 0.2
    header.BorderSizePixel = 0
    header.Parent = mainFrame
    
    local headerCorner = Instance.new("UICorner")
    headerCorner.CornerRadius = UDim.new(0, 12)
    headerCorner.Parent = header
    
    -- Title
    local title = Instance.new("TextLabel")
    title.Name = "Title"
    title.Size = UDim2.new(1, -60, 1, 0)
    title.Position = UDim2.new(0, 10, 0, 0)
    title.BackgroundTransparency = 1
    title.Text = "SKY CONTROL"
    title.TextColor3 = Color3.fromRGB(255, 255, 255)
    title.TextSize = 14
    title.Font = Enum.Font.GothamBold
    title.Parent = header
    
    -- Minimize Button
    local minimizeButton = Instance.new("TextButton")
    minimizeButton.Name = "MinimizeButton"
    minimizeButton.Size = UDim2.new(0, 20, 0, 20)
    minimizeButton.Position = UDim2.new(1, -50, 0.5, -10)
    minimizeButton.BackgroundColor3 = Color3.fromRGB(255, 180, 40)
    minimizeButton.Text = "-"
    minimizeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    minimizeButton.TextSize = 14
    minimizeButton.Font = Enum.Font.GothamBold
    minimizeButton.BorderSizePixel = 0
    minimizeButton.Parent = header
    
    local minimizeCorner = Instance.new("UICorner")
    minimizeCorner.CornerRadius = UDim.new(0, 10)
    minimizeCorner.Parent = minimizeButton
    
    -- Close Button
    local closeButton = Instance.new("TextButton")
    closeButton.Name = "CloseButton"
    closeButton.Size = UDim2.new(0, 20, 0, 20)
    closeButton.Position = UDim2.new(1, -25, 0.5, -10)
    closeButton.BackgroundColor3 = Color3.fromRGB(220, 60, 60)
    closeButton.Text = "âœ•"
    closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    closeButton.TextSize = 14
    closeButton.Font = Enum.Font.GothamBold
    closeButton.BorderSizePixel = 0
    closeButton.Parent = header
    
    local closeCorner = Instance.new("UICorner")
    closeCorner.CornerRadius = UDim.new(0, 10)
    closeCorner.Parent = closeButton
    
    -- Content Frame
    local contentFrame = Instance.new("Frame")
    contentFrame.Name = "ContentFrame"
    contentFrame.Size = UDim2.new(1, 0, 1, -30)
    contentFrame.Position = UDim2.new(0, 0, 0, 30)
    contentFrame.BackgroundTransparency = 1
    contentFrame.Parent = mainFrame
    
    -- Up Button
    local upButton = Instance.new("TextButton")
    upButton.Name = "UpButton"
    upButton.Size = UDim2.new(0, 160, 0, 30)
    upButton.Position = UDim2.new(0.5, -80, 0, 20)
    upButton.BackgroundColor3 = Color3.fromRGB(60, 180, 100)
    upButton.Text = "â†‘ UP â†‘"
    upButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    upButton.TextSize = 14
    upButton.Font = Enum.Font.GothamBold
    upButton.BorderSizePixel = 0
    upButton.Parent = contentFrame
    
    local upCorner = Instance.new("UICorner")
    upCorner.CornerRadius = UDim.new(0, 8)
    upCorner.Parent = upButton
    
    -- Down Button
    local downButton = Instance.new("TextButton")
    downButton.Name = "DownButton"
    downButton.Size = UDim2.new(0, 160, 0, 30)
    downButton.Position = UDim2.new(0.5, -80, 0, 60)
    downButton.BackgroundColor3 = Color3.fromRGB(180, 80, 80)
    downButton.Text = "â†“ DOWN â†“"
    downButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    downButton.TextSize = 14
    downButton.Font = Enum.Font.GothamBold
    downButton.BorderSizePixel = 0
    downButton.Parent = contentFrame
    
    local downCorner = Instance.new("UICorner")
    downCorner.CornerRadius = UDim.new(0, 8)
    downCorner.Parent = downButton
    
    -- TP to Base Button
    local tpBaseButton = Instance.new("TextButton")
    tpBaseButton.Name = "TpBaseButton"
    tpBaseButton.Size = UDim2.new(0, 160, 0, 30)
    tpBaseButton.Position = UDim2.new(0.5, -80, 0, 100)
    tpBaseButton.BackgroundColor3 = Color3.fromRGB(100, 100, 255)
    tpBaseButton.Text = "TP TO BASE"
    tpBaseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    tpBaseButton.TextSize = 14
    tpBaseButton.Font = Enum.Font.GothamBold
    tpBaseButton.BorderSizePixel = 0
    tpBaseButton.Parent = contentFrame
    
    local tpBaseCorner = Instance.new("UICorner")
    tpBaseCorner.CornerRadius = UDim.new(0, 8)
    tpBaseCorner.Parent = tpBaseButton
    
    -- Set Position Button
    local setPositionButton = Instance.new("TextButton")
    setPositionButton.Name = "SetPositionButton"
    setPositionButton.Size = UDim2.new(0, 160, 0, 30)
    setPositionButton.Position = UDim2.new(0.5, -80, 0, 140)
    setPositionButton.BackgroundColor3 = Color3.fromRGB(150, 100, 200)
    setPositionButton.Text = "ðŸ“ SET CURRENT POS"
    setPositionButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    setPositionButton.TextSize = 12
    setPositionButton.Font = Enum.Font.GothamBold
    setPositionButton.BorderSizePixel = 0
    setPositionButton.Parent = contentFrame
    
    local setPositionCorner = Instance.new("UICorner")
    setPositionCorner.CornerRadius = UDim.new(0, 8)
    setPositionCorner.Parent = setPositionButton
    
    -- Minimize functionality
    local function toggleMinimize()
        skyWidgetMinimized = not skyWidgetMinimized
        contentFrame.Visible = not skyWidgetMinimized
        mainFrame.Size = UDim2.new(0, 180, contentFrame.Visible and 190 or 30)
        minimizeButton.Text = contentFrame.Visible and "-" or "+"
    end
    
    -- Button connections
    minimizeButton.MouseButton1Click:Connect(toggleMinimize)
    
    closeButton.MouseButton1Click:Connect(function()
        skyWidget:Destroy()
        skyWidget = nil
        skyWidgetVisible = false
    end)
    
    upButton.MouseButton1Click:Connect(teleportUp)
    downButton.MouseButton1Click:Connect(teleportDown)
    tpBaseButton.MouseButton1Click:Connect(teleportToBase)
    
    setPositionButton.MouseButton1Click:Connect(function()
        pcall(function()
            local char = LocalPlayer.Character
            if char and char:FindFirstChild("HumanoidRootPart") then
                basePosition = char.HumanoidRootPart.Position
                Rayfield:Notify({
                    Title = "Position Set",
                    Content = "Current position saved as base!",
                    Duration = 2,
                    Image = 4483362458
                })
            end
        end)
    end)
    
    skyWidgetVisible = true
end

-- Create Boost GUI
local function createBoostGui()
    if boostGui then
        boostGui:Destroy()
    end
    
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "BoostGui"
    screenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")
    screenGui.ResetOnSpawn = false
    boostGui = screenGui
    
    -- Main Frame
    local mainFrame = Instance.new("Frame")
    mainFrame.Name = "MainFrame"
    mainFrame.Size = UDim2.new(0, 120, 0, 40)
    mainFrame.Position = UDim2.new(0, 20, 0.5, -20)
    mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 45)
    mainFrame.BackgroundTransparency = 0.1
    mainFrame.BorderSizePixel = 0
    mainFrame.Parent = screenGui
    mainFrame.Active = true
    mainFrame.Draggable = true
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 8)
    corner.Parent = mainFrame
    
    -- Toggle Button
    local boostButton = Instance.new("TextButton")
    boostButton.Name = "BoostButton"
    boostButton.Size = UDim2.new(1, 0, 1, 0)
    boostButton.Position = UDim2.new(0, 0, 0, 0)
    boostButton.BackgroundColor3 = Color3.fromRGB(70, 120, 200)
    boostButton.Text = "BOOST: OFF"
    boostButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    boostButton.TextSize = 14
    boostButton.Font = Enum.Font.GothamBold
    boostButton.BorderSizePixel = 0
    boostButton.Parent = mainFrame
    
    local boostCorner = Instance.new("UICorner")
    boostCorner.CornerRadius = UDim.new(0, 8)
    boostCorner.Parent = boostButton
    
    boostButton.MouseButton1Click:Connect(function()
        boostActive = not boostActive
        local char = LocalPlayer.Character
        if char then
            local humanoid = char:FindFirstChild("Humanoid")
            if humanoid then
                if boostActive then
                    humanoid.WalkSpeed = originalSpeed * 1.7
                    boostButton.Text = "BOOST: ON"
                    boostButton.BackgroundColor3 = Color3.fromRGB(200, 120, 70)
                else
                    humanoid.WalkSpeed = originalSpeed
                    boostButton.Text = "BOOST: OFF"
                    boostButton.BackgroundColor3 = Color3.fromRGB(70, 120, 200)
                end
            end
        end
    end)
end

-- Character setup
local function setupCharacter()
    repeat task.wait(0.1) until LocalPlayer.Character
    repeat task.wait(0.1) until LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
    basePosition = LocalPlayer.Character.HumanoidRootPart.Position
end

if LocalPlayer.Character then
    setupCharacter()
end

LocalPlayer.CharacterAdded:Connect(setupCharacter)

-- Initialize anti-kick
pcall(antiKick)

-- Create UI
local Window = Rayfield:CreateWindow({
    Name = "Brainrot Hub Pro",
    LoadingTitle = "Loading Pro Version...",
    LoadingSubtitle = "Admin tools for everyone",
    ConfigurationSaving = {Enabled = false},
    Discord = {Enabled = false},
    KeySystem = false
})

-- Main Tab
local MainTab = Window:CreateTab("Main", 4483362458)

-- Combat Tab
local CombatTab = Window:CreateTab("Combat", 4483362458)

-- ESP Tab
local ESPTab = Window:CreateTab("ESP", 4483362458)

-- GUI Tab
local GUITab = Window:CreateTab("GUI", 4483362458)

-- Boost Tab
local BoostTab = Window:CreateTab("Boost", 4483362458)

-- Main Tab Features
MainTab:CreateSection("Features")

-- Fast Steal toggle
MainTab:CreateToggle({
    Name = "Fast Steal (0.5s)",
    Default = false,
    Callback = function(value)
        fastStealEnabled = value
        if value then
            setupFastSteal()
            Rayfield:Notify({
                Title = "Fast Steal Attivato",
                Content = "Furto istantaneo (0.5s) attivo!",
                Duration = 2,
                Image = 4483362458
            })
        else
            if fastStealConnection then
                fastStealConnection:Disconnect()
                fastStealConnection = nil
            end
            Rayfield:Notify({
                Title = "Fast Steal Disattivato",
                Content = "Furto istantaneo disattivato",
                Duration = 1.5,
                Image = 4483362458
            })
        end
    end
})

-- Auto Collect Money toggle
MainTab:CreateToggle({
    Name = "Auto Collect Money",
    Default = false,
    Callback = function(value)
        autoCollectMoneyEnabled = value
        if value then
            setupAutoCollectMoney()
            Rayfield:Notify({
                Title = "Auto Collect Money",
                Content = "Activated - Collecting all nearby money",
                Duration = 2,
                Image = 4483362458
            })
        else
            if autoCollectConnection then
                autoCollectConnection:Disconnect()
                autoCollectConnection = nil
            end
            Rayfield:Notify({
                Title = "Auto Collect Money",
                Content = "Deactivated",
                Duration = 1.5,
                Image = 4483362458
            })
        end
    end
})

-- Combat Tab Features
CombatTab:CreateToggle({
    Name = "God Mode (No Hit/No Fall)",
    Default = false,
    Callback = function(value)
        setGodMode(value)
        Rayfield:Notify({
            Title = "God Mode",
            Content = value and "ON - Invincible" or "OFF",
            Duration = 1.5,
            Image = 4483362458
        })
    end
})

CombatTab:CreateToggle({
    Name = "Kill Aura 360Â°",
    Default = false,
    Callback = function(value)
        if value then
            startKillAura()
            Rayfield:Notify({
                Title = "Kill Aura",
                Content = "Activated",
                Duration = 1.5,
                Image = 4483362458
            })
        else
            stopKillAura()
            Rayfield:Notify({
                Title = "Kill Aura",
                Content = "Deactivated",
                Duration = 1.5,
                Image = 4483362458
            })
        end
    end
})

CombatTab:CreateButton({
    Name = "Remove Walls",
    Callback = removeWalls
})

-- ESP Tab Features
ESPTab:CreateToggle({
    Name = "ESP Players",
    Default = false,
    Callback = toggleESP
})

ESPTab:CreateColorPicker({
    Name = "ESP Color",
    Color = Color3.fromRGB(255, 0, 0),
    Callback = function(color)
        for player, highlight in pairs(espObjects) do
            if player ~= LocalPlayer then
                highlight.OutlineColor = color
                if player.Character then
                    local head = player.Character:FindFirstChild("Head")
                    if head and head:FindFirstChild("ESPTag") then
                        head.ESPTag.TextLabel.TextColor3 = color
                    end
                end
            end
        end
    end
})

-- GUI Tab Features
GUITab:CreateButton({
    Name = "Sky GUI",
    Callback = function()
        if not skyWidgetVisible then
            createSkyWidget()
        end
    end
})

GUITab:CreateButton({
    Name = "Leave GUI",
    Callback = createLeaveGui
})

-- Boost Tab Features
BoostTab:CreateButton({
    Name = "Activate Speed Boost",
    Callback = function()
        createBoostGui()
        Rayfield:Notify({
            Title = "Boost Overlay",
            Content = "Boost overlay activated!",
            Duration = 2,
            Image = 4483362458
        })
    end
})

-- Success notification
Rayfield:Notify({
    Title = "Brainrot Hub Pro Loaded",
    Content = "All features activated!",
    Duration = 3,
    Image = 4483362458
})
