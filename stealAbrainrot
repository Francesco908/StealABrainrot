-- Water Hub - Roblox Script
-- Optimized for mobile users with comprehensive features

local Library = loadstring(game:HttpGet("https://github.com/dawid-scripts/Fluent/releases/latest/download/main.lua"))()

-- Services
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Workspace = game:GetService("Workspace")

-- Variables
local Player = Players.LocalPlayer
local Character = Player.Character or Player.CharacterAdded:Wait()
local Humanoid = Character:WaitForChild("Humanoid")
local RootPart = Character:WaitForChild("HumanoidRootPart")

-- Settings
local Settings = {
    AutoCollectMoney = false,
    SpeedBoost = false,
    JumpBoost = false,
    InfinityJump = false,
    GodMode = false,
    Float = false,
    StealHelper = false,
    ESP = {
        Players = false,
        Names = false
    },
    AutoLock = false,
    LockPoint = nil,
    HelperUp = 165,
    HelperDown = 50,
    SpeedValue = 16,
    JumpValue = 50
}

-- GUI Variables
local StealHelperGui = nil
local AutoLockGui = nil
local LockPointSet = false

-- Create Window
local Window = Library:CreateWindow({
    Title = "Water Hub",
    SubTitle = "Premium Mobile Script",
    TabWidth = 160,
    Size = UDim2.fromOffset(580, 460),
    Acrylic = true,
    Theme = "Darker",
    MinimizeKey = Enum.KeyCode.LeftControl
})

-- Main Tab
local MainTab = Window:AddTab({
    Title = "Main",
    Icon = "home"
})

-- ESP Tab
local ESPTab = Window:AddTab({
    Title = "ESP",
    Icon = "eye"
})

-- Misc Tab
local MiscTab = Window:AddTab({
    Title = "Misc",
    Icon = "settings"
})

-- Helper Functions
local function GetCharacter()
    return Player.Character or Player.CharacterAdded:Wait()
end

local function GetHumanoid()
    local char = GetCharacter()
    return char:WaitForChild("Humanoid")
end

local function GetRootPart()
    local char = GetCharacter()
    return char:WaitForChild("HumanoidRootPart")
end

-- Auto Collect Money Function
local function AutoCollectMoney()
    spawn(function()
        while Settings.AutoCollectMoney do
            wait(0.1)
            for _, obj in pairs(Workspace:GetChildren()) do
                if obj.Name:lower():find("money") or obj.Name:lower():find("cash") or obj.Name:lower():find("coin") then
                    if obj:FindFirstChild("ClickDetector") then
                        fireclickdetector(obj.ClickDetector)
                    elseif obj:FindFirstChild("ProximityPrompt") then
                        fireproximityprompt(obj.ProximityPrompt)
                    end
                end
            end
        end
    end)
end

-- Speed Boost Function (Persistent)
local function SpeedBoost()
    spawn(function()
        while Settings.SpeedBoost do
            wait(0.1)
            local humanoid = GetHumanoid()
            if humanoid then
                humanoid.WalkSpeed = Settings.SpeedValue
            end
        end
    end)
end

-- Jump Boost Function
local function JumpBoost()
    spawn(function()
        while Settings.JumpBoost do
            wait(0.1)
            local humanoid = GetHumanoid()
            if humanoid then
                humanoid.JumpPower = Settings.JumpValue
            end
        end
    end)
end

-- Infinity Jump Function
local function InfinityJump()
    local connection
    connection = UserInputService.JumpRequest:Connect(function()
        if Settings.InfinityJump then
            local humanoid = GetHumanoid()
            if humanoid then
                humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
            end
        end
    end)
    
    return connection
end

-- God Mode Function
local function GodMode()
    spawn(function()
        while Settings.GodMode do
            wait(0.1)
            local humanoid = GetHumanoid()
            if humanoid then
                humanoid.Health = humanoid.MaxHealth
            end
        end
    end)
end

-- Float Function
local function Float()
    local bodyVelocity
    spawn(function()
        while Settings.Float do
            wait(0.1)
            local rootPart = GetRootPart()
            if rootPart and not bodyVelocity then
                bodyVelocity = Instance.new("BodyVelocity")
                bodyVelocity.MaxForce = Vector3.new(0, math.huge, 0)
                bodyVelocity.Velocity = Vector3.new(0, 0, 0)
                bodyVelocity.Parent = rootPart
            end
        end
        
        if bodyVelocity then
            bodyVelocity:Destroy()
            bodyVelocity = nil
        end
    end)
end

-- Create Steal Helper GUI
local function CreateStealHelperGui()
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "StealHelperGui"
    ScreenGui.Parent = Player.PlayerGui
    
    local Frame = Instance.new("Frame")
    Frame.Size = UDim2.new(0, 200, 0, 100)
    Frame.Position = UDim2.new(0.5, -100, 0.5, -50)
    Frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    Frame.BorderSizePixel = 0
    Frame.Parent = ScreenGui
    
    local Corner = Instance.new("UICorner")
    Corner.CornerRadius = UDim.new(0, 10)
    Corner.Parent = Frame
    
    local Title = Instance.new("TextLabel")
    Title.Size = UDim2.new(1, 0, 0, 30)
    Title.Position = UDim2.new(0, 0, 0, 0)
    Title.BackgroundTransparency = 1
    Title.Text = "Steal Helper"
    Title.TextColor3 = Color3.fromRGB(255, 255, 255)
    Title.TextScaled = true
    Title.Font = Enum.Font.SourceSansBold
    Title.Parent = Frame
    
    local UpButton = Instance.new("TextButton")
    UpButton.Size = UDim2.new(0.4, 0, 0, 30)
    UpButton.Position = UDim2.new(0.05, 0, 0.4, 0)
    UpButton.BackgroundColor3 = Color3.fromRGB(0, 170, 0)
    UpButton.Text = "UP (" .. Settings.HelperUp .. ")"
    UpButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    UpButton.TextScaled = true
    UpButton.Font = Enum.Font.SourceSans
    UpButton.Parent = Frame
    
    local DownButton = Instance.new("TextButton")
    DownButton.Size = UDim2.new(0.4, 0, 0, 30)
    DownButton.Position = UDim2.new(0.55, 0, 0.4, 0)
    DownButton.BackgroundColor3 = Color3.fromRGB(170, 0, 0)
    DownButton.Text = "DOWN (" .. Settings.HelperDown .. ")"
    DownButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    DownButton.TextScaled = true
    DownButton.Font = Enum.Font.SourceSans
    DownButton.Parent = Frame
    
    local CloseButton = Instance.new("TextButton")
    CloseButton.Size = UDim2.new(0, 20, 0, 20)
    CloseButton.Position = UDim2.new(1, -25, 0, 5)
    CloseButton.BackgroundColor3 = Color3.fromRGB(170, 0, 0)
    CloseButton.Text = "X"
    CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    CloseButton.TextScaled = true
    CloseButton.Font = Enum.Font.SourceSansBold
    CloseButton.Parent = Frame
    
    -- Make draggable
    local dragging = false
    local dragInput, mousePos, framePos
    
    Frame.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            mousePos = input.Position
            framePos = Frame.Position
        end
    end)
    
    Frame.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            dragInput = input
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            local delta = input.Position - mousePos
            Frame.Position = UDim2.new(framePos.X.Scale, framePos.X.Offset + delta.X, framePos.Y.Scale, framePos.Y.Offset + delta.Y)
        end
    end)
    
    Frame.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = false
        end
    end)
    
    -- Button functions
    UpButton.MouseButton1Click:Connect(function()
        local rootPart = GetRootPart()
        if rootPart then
            rootPart.CFrame = rootPart.CFrame + Vector3.new(0, Settings.HelperUp, 0)
        end
    end)
    
    DownButton.MouseButton1Click:Connect(function()
        local rootPart = GetRootPart()
        if rootPart then
            rootPart.CFrame = rootPart.CFrame - Vector3.new(0, Settings.HelperDown, 0)
        end
    end)
    
    CloseButton.MouseButton1Click:Connect(function()
        ScreenGui:Destroy()
        StealHelperGui = nil
    end)
    
    StealHelperGui = ScreenGui
end

-- Create Auto Lock GUI
local function CreateAutoLockGui()
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "AutoLockGui"
    ScreenGui.Parent = Player.PlayerGui
    
    local Frame = Instance.new("Frame")
    Frame.Size = UDim2.new(0, 250, 0, 120)
    Frame.Position = UDim2.new(0.5, -125, 0.5, -60)
    Frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    Frame.BorderSizePixel = 0
    Frame.Parent = ScreenGui
    
    local Corner = Instance.new("UICorner")
    Corner.CornerRadius = UDim.new(0, 10)
    Corner.Parent = Frame
    
    local Title = Instance.new("TextLabel")
    Title.Size = UDim2.new(1, 0, 0, 30)
    Title.Position = UDim2.new(0, 0, 0, 0)
    Title.BackgroundTransparency = 1
    Title.Text = "Auto Lock"
    Title.TextColor3 = Color3.fromRGB(255, 255, 255)
    Title.TextScaled = true
    Title.Font = Enum.Font.SourceSansBold
    Title.Parent = Frame
    
    local LockButton = Instance.new("TextButton")
    LockButton.Size = UDim2.new(0.4, 0, 0, 30)
    LockButton.Position = UDim2.new(0.05, 0, 0.35, 0)
    LockButton.BackgroundColor3 = Color3.fromRGB(0, 170, 0)
    LockButton.Text = "Lock"
    LockButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    LockButton.TextScaled = true
    LockButton.Font = Enum.Font.SourceSans
    LockButton.Parent = Frame
    
    local SetLockButton = Instance.new("TextButton")
    SetLockButton.Size = UDim2.new(0.4, 0, 0, 30)
    SetLockButton.Position = UDim2.new(0.55, 0, 0.35, 0)
    SetLockButton.BackgroundColor3 = Color3.fromRGB(0, 100, 170)
    SetLockButton.Text = "Set Lock Point"
    SetLockButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    SetLockButton.TextScaled = true
    SetLockButton.Font = Enum.Font.SourceSans
    SetLockButton.Parent = Frame
    
    local StatusLabel = Instance.new("TextLabel")
    StatusLabel.Size = UDim2.new(0.9, 0, 0, 25)
    StatusLabel.Position = UDim2.new(0.05, 0, 0.7, 0)
    StatusLabel.BackgroundTransparency = 1
    StatusLabel.Text = "Lock point not set"
    StatusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
    StatusLabel.TextScaled = true
    StatusLabel.Font = Enum.Font.SourceSans
    StatusLabel.Parent = Frame
    
    local CloseButton = Instance.new("TextButton")
    CloseButton.Size = UDim2.new(0, 20, 0, 20)
    CloseButton.Position = UDim2.new(1, -25, 0, 5)
    CloseButton.BackgroundColor3 = Color3.fromRGB(170, 0, 0)
    CloseButton.Text = "X"
    CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    CloseButton.TextScaled = true
    CloseButton.Font = Enum.Font.SourceSansBold
    CloseButton.Parent = Frame
    
    -- Make draggable
    local dragging = false
    local dragInput, mousePos, framePos
    
    Frame.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            mousePos = input.Position
            framePos = Frame.Position
        end
    end)
    
    Frame.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            dragInput = input
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            local delta = input.Position - mousePos
            Frame.Position = UDim2.new(framePos.X.Scale, framePos.X.Offset + delta.X, framePos.Y.Scale, framePos.Y.Offset + delta.Y)
        end
    end)
    
    Frame.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = false
        end
    end)
    
    -- Button functions
    SetLockButton.MouseButton1Click:Connect(function()
        local rootPart = GetRootPart()
        if rootPart then
            Settings.LockPoint = rootPart.Position
            LockPointSet = true
            StatusLabel.Text = "Lock point set!"
            StatusLabel.TextColor3 = Color3.fromRGB(100, 255, 100)
        end
    end)
    
    LockButton.MouseButton1Click:Connect(function()
        if not LockPointSet then
            StatusLabel.Text = "Lock point not set!"
            StatusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
            return
        end
        
        -- Respawn character
        local humanoid = GetHumanoid()
        if humanoid then
            humanoid.Health = 0
            
            -- Wait for respawn and move to lock point
            Player.CharacterAdded:Connect(function(newChar)
                wait(2)
                local newRootPart = newChar:WaitForChild("HumanoidRootPart")
                local newHumanoid = newChar:WaitForChild("Humanoid")
                
                if Settings.LockPoint then
                    newHumanoid:MoveTo(Settings.LockPoint)
                end
            end)
        end
    end)
    
    CloseButton.MouseButton1Click:Connect(function()
        ScreenGui:Destroy()
        AutoLockGui = nil
    end)
    
    AutoLockGui = ScreenGui
end

-- ESP Functions
local function CreateESP(player)
    if player == Player then return end
    
    local esp = {
        Player = player,
        Connections = {},
        Objects = {}
    }
    
    local function UpdateESP()
        if not Settings.ESP.Players then return end
        
        local character = player.Character
        if not character then return end
        
        local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
        if not humanoidRootPart then return end
        
        -- Create or update player ESP
        if not esp.Objects.Box then
            local billboardGui = Instance.new("BillboardGui")
            billboardGui.Size = UDim2.new(4, 0, 6, 0)
            billboardGui.StudsOffset = Vector3.new(0, 0, 0)
            billboardGui.Parent = humanoidRootPart
            
            local frame = Instance.new("Frame")
            frame.Size = UDim2.new(1, 0, 1, 0)
            frame.BackgroundTransparency = 1
            frame.BorderSizePixel = 2
            frame.BorderColor3 = Color3.fromRGB(255, 0, 0)
            frame.Parent = billboardGui
            
            esp.Objects.Box = billboardGui
        end
        
        -- Create or update name ESP
        if Settings.ESP.Names and not esp.Objects.Name then
            local nameGui = Instance.new("BillboardGui")
            nameGui.Size = UDim2.new(0, 200, 0, 50)
            nameGui.StudsOffset = Vector3.new(0, 3, 0)
            nameGui.Parent = humanoidRootPart
            
            local nameLabel = Instance.new("TextLabel")
            nameLabel.Size = UDim2.new(1, 0, 1, 0)
            nameLabel.BackgroundTransparency = 1
            nameLabel.Text = player.Name
            nameLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
            nameLabel.TextScaled = true
            nameLabel.Font = Enum.Font.SourceSansBold
            nameLabel.Parent = nameGui
            
            esp.Objects.Name = nameGui
        end
    end
    
    local connection = RunService.Heartbeat:Connect(UpdateESP)
    esp.Connections[#esp.Connections + 1] = connection
    
    return esp
end

-- Main Tab Features
MainTab:AddToggle("AutoCollectMoney", {
    Title = "Auto Collect Money",
    Description = "Automatically collect money items",
    Default = false,
    Callback = function(Value)
        Settings.AutoCollectMoney = Value
        if Value then
            AutoCollectMoney()
        end
    end
})

MainTab:AddToggle("SpeedBoost", {
    Title = "Speed Boost",
    Description = "Persistent speed boost",
    Default = false,
    Callback = function(Value)
        Settings.SpeedBoost = Value
        if Value then
            SpeedBoost()
        else
            local humanoid = GetHumanoid()
            if humanoid then
                humanoid.WalkSpeed = 16
            end
        end
    end
})

MainTab:AddToggle("JumpBoost", {
    Title = "Jump Boost",
    Description = "Increase jump power",
    Default = false,
    Callback = function(Value)
        Settings.JumpBoost = Value
        if Value then
            JumpBoost()
        else
            local humanoid = GetHumanoid()
            if humanoid then
                humanoid.JumpPower = 50
            end
        end
    end
})

MainTab:AddToggle("InfinityJump", {
    Title = "Infinity Jump",
    Description = "Jump infinitely",
    Default = false,
    Callback = function(Value)
        Settings.InfinityJump = Value
        if Value then
            InfinityJump()
        end
    end
})

MainTab:AddToggle("GodMode", {
    Title = "God Mode",
    Description = "Invincibility mode",
    Default = false,
    Callback = function(Value)
        Settings.GodMode = Value
        if Value then
            GodMode()
        end
    end
})

MainTab:AddToggle("Float", {
    Title = "Float",
    Description = "Float in the air",
    Default = false,
    Callback = function(Value)
        Settings.Float = Value
        if Value then
            Float()
        end
    end
})

MainTab:AddButton({
    Title = "Steal Helper",
    Description = "Open steal helper GUI",
    Callback = function()
        if not StealHelperGui then
            CreateStealHelperGui()
        end
    end
})

-- ESP Tab Features
ESPTab:AddToggle("ESPPlayers", {
    Title = "ESP Players",
    Description = "Show player ESP boxes",
    Default = false,
    Callback = function(Value)
        Settings.ESP.Players = Value
        if not Value then
            -- Clear ESP
            for _, player in pairs(Players:GetPlayers()) do
                if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                    for _, gui in pairs(player.Character.HumanoidRootPart:GetChildren()) do
                        if gui:IsA("BillboardGui") then
                            gui:Destroy()
                        end
                    end
                end
            end
        end
    end
})

ESPTab:AddToggle("ESPNames", {
    Title = "ESP Names",
    Description = "Show player names",
    Default = false,
    Callback = function(Value)
        Settings.ESP.Names = Value
    end
})

-- Misc Tab Features
MiscTab:AddButton({
    Title = "Auto Lock",
    Description = "Open auto lock GUI",
    Callback = function()
        if not AutoLockGui then
            CreateAutoLockGui()
        end
    end
})

-- Player ESP Management
local playerESPs = {}

Players.PlayerAdded:Connect(function(player)
    playerESPs[player] = CreateESP(player)
end)

Players.PlayerRemoving:Connect(function(player)
    if playerESPs[player] then
        for _, connection in pairs(playerESPs[player].Connections) do
            connection:Disconnect()
        end
        playerESPs[player] = nil
    end
end)

-- Initialize ESP for existing players
for _, player in pairs(Players:GetPlayers()) do
    if player ~= Player then
        playerESPs[player] = CreateESP(player)
    end
end

-- Character respawn handling
Player.CharacterAdded:Connect(function(newChar)
    Character = newChar
    Humanoid = Character:WaitForChild("Humanoid")
    RootPart = Character:WaitForChild("HumanoidRootPart")
    
    -- Reapply settings after respawn
    if Settings.SpeedBoost then
        SpeedBoost()
    end
    if Settings.JumpBoost then
        JumpBoost()
    end
    if Settings.GodMode then
        GodMode()
    end
    if Settings.Float then
        Float()
    end
    if Settings.AutoCollectMoney then
        AutoCollectMoney()
    end
end)

-- Notification
Library:Notify({
    Title = "Water Hub",
    Content = "Script loaded successfully!",
    Duration = 5
})
