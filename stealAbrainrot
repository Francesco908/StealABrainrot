-- Brainrot Universal Script v2: Complete Enhanced UI & Original Features
-- Rayfield loading (multiple sources)
local Rayfield
pcall(function()
    Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()
end)
if not Rayfield then
    pcall(function()
        Rayfield = loadstring(game:HttpGet('https://raw.githubusercontent.com/shlexware/Rayfield/main/source'))()
    end)
end
if not Rayfield then return end

-- Wait for game to load
repeat wait(0.1) until game:IsLoaded()

-- Services & Player
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local TeleportService = game:GetService("TeleportService")
local LocalPlayer = Players.LocalPlayer

-- Variables & Config
local Config = {
    basePosition = Vector3.new(0,10,0),
    originalSpeed = 16,
    killAuraRange = 20,
    bypassSpeedFactor = 1.15,
    killAuraActive = false,
    killAuraConnection = nil,
    godMode = false,
    antiRagdoll = false,
    autoWalk = false,
}

-- Anti-Kick
local function antiKick()
    local mt = getrawmetatable(game)
    setreadonly(mt,false)
    local old = mt.__namecall
    mt.__namecall = newcclosure(function(self, ...)
        if getnamecallmethod()=="Kick" then return end
        return old(self, ...)
    end)
    setreadonly(mt,true)
end
pcall(antiKick)

-- Teleport Helpers
local function teleportTo(pos)
    local char = LocalPlayer.Character
    if char and char:FindFirstChild("HumanoidRootPart") then
        local hrp = char.HumanoidRootPart
        local dist = (hrp.Position - pos).Magnitude
        local duration = math.max(dist/(Config.originalSpeed*Config.bypassSpeedFactor), 0.1)
        TweenService:Create(hrp, TweenInfo.new(duration,Enum.EasingStyle.Linear),{CFrame=CFrame.new(pos)}):Play()
    end
end

local function teleportUp()
    pcall(function()
        local char = LocalPlayer.Character
        if char and char:FindFirstChild("HumanoidRootPart") then
            local pos = char.HumanoidRootPart.Position
            teleportTo(pos + Vector3.new(0,256,0))
        end
    end)
end

local function teleportDown()
    pcall(function()
        local char = LocalPlayer.Character
        if char and char:FindFirstChild("HumanoidRootPart") then
            local pos = char.HumanoidRootPart.Position
            teleportTo(pos - Vector3.new(0,50,0))
        end
    end)
end

-- Natural Walk (alias for autoWalk)
local function naturalWalk()
    teleportTo(Config.basePosition)
end

-- Kill Aura
local function startKillAura()
    if Config.killAuraActive then return end
    Config.killAuraActive = true
    Config.killAuraConnection = RunService.Heartbeat:Connect(function()
        pcall(function()
            local char = LocalPlayer.Character
            if not (char and char:FindFirstChild("HumanoidRootPart")) then return end
            local tool = LocalPlayer.Backpack:FindFirstChildOfClass("Tool") or char:FindFirstChildOfClass("Tool")
            if not tool then return end
            for _,p in pairs(Players:GetPlayers()) do
                if p~=LocalPlayer and p.Character and p.Character:FindFirstChild("HumanoidRootPart") then
                    local d = (p.Character.HumanoidRootPart.Position - char.HumanoidRootPart.Position).Magnitude
                    if d < Config.killAuraRange then
                        char.Humanoid:EquipTool(tool)
                        tool:Activate()
                        wait(0.05)
                    end
                end
            end
        end)
    end)
end

local function stopKillAura()
    if Config.killAuraConnection then Config.killAuraConnection:Disconnect() end
    Config.killAuraActive = false
end

-- Toggle Functions
local function toggleGodMode(val)
    Config.godMode = val
    local char = LocalPlayer.Character
    if not char then return end
    for _,part in pairs(char:GetChildren()) do
        if part:IsA("BasePart") then part.CanCollide = not val end
    end
    if char:FindFirstChild("Humanoid") then
        char.Humanoid.MaxHealth = val and math.huge or 100
        char.Humanoid.Health = char.Humanoid.MaxHealth
    end
end

local function toggleAntiRagdoll(val)
    Config.antiRagdoll = val
    local char = LocalPlayer.Character
    if not char then return end
    if val then
        for _,part in pairs(char:GetChildren()) do
            if part:IsA("BasePart") then part.CustomPhysicalProperties = PhysicalProperties.new(0,0,0,0,0) end
        end
    end
end

-- Auto-set base on spawn/move
local function updateBase()
    local char = LocalPlayer.Character
    if char and char:FindFirstChild("HumanoidRootPart") then
        Config.basePosition = char.HumanoidRootPart.Position
    end
end

local function setupCharacter()
    repeat wait(0.1) until LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
    updateBase()
end
LocalPlayer.CharacterAdded:Connect(setupCharacter)
if LocalPlayer.Character then setupCharacter() end

-- GUI Factory
globalGUI = {}
local function createMinimizableGui(name)
    local gui = Instance.new("ScreenGui",LocalPlayer.PlayerGui)
    gui.Name,name = name,name; gui.ResetOnSpawn=false
    local frame = Instance.new("Frame",gui)
    frame.Size,frame.Position = UDim2.new(0,300,0,150),UDim2.new(0.5,-150,0.5,-75)
    frame.BackgroundColor3,frame.BackgroundTransparency = Color3.fromRGB(25,25,35),0.05
    frame.Active,frame.Draggable=true,true; Instance.new("UICorner",frame).CornerRadius=UDim.new(0,16)
    local header=Instance.new("Frame",frame); header.Size=UDim2.new(1,0,0,30); header.BackgroundTransparency=1
    local title=Instance.new("TextLabel",header); title.Size, title.Position = UDim2.new(1,-60,1,0),UDim2.new(0,10,0,0)
    title.BackgroundTransparency,title.Text,title.Font,title.TextSize,title.TextColor3 = 1,name,Enum.Font.GothamBold,18,Color3.new(1,1,1)
    local minBtn=Instance.new("TextButton",header)
    minBtn.Size,minBtn.Position = UDim2.new(0,25,0,25),UDim2.new(1,-50,0,2)
    minBtn.Text,minBtn.Font,minBtn.TextSize,minBtn.BackgroundTransparency,minBtn.BackgroundColor3 = "−",Enum.Font.GothamBold,18,0.2,Color3.fromRGB(50,50,70)
    local content=Instance.new("Frame",frame); content.Name="Content" content.Size,content.Position = UDim2.new(1,0,1,-30),UDim2.new(0,0,0,30)
    local minimized=false
    minBtn.MouseButton1Click:Connect(function()
        minimized = not minimized; content.Visible = not minimized
        frame.Size = minimized and UDim2.new(0,300,0,30) or UDim2.new(0,300,0,150)
        minBtn.Text = minimized and "+" or "−"
    end)
    return gui,content
end

-- Create Specific GUIs
local function createBaseGui()
    if globalGUI.BaseGui then globalGUI.BaseGui:Destroy() end
    local gui,content = createMinimizableGui("🏠 Base Control")
    globalGUI.BaseGui = gui
    -- Set Position
    local setBtn = Instance.new("TextButton",content)
    setBtn.Size,setBtn.Position = UDim2.new(0,120,0,35),UDim2.new(0.05,0,0.1,0)
    setBtn.Text,setBtn.Font,setBtn.TextSize,setBtn.TextColor3 = "📍 Set Position",Enum.Font.GothamBold,14,Color3.new(1,1,1)
    setBtn.BackgroundTransparency,setBtn.BackgroundColor3 = 0.1,Color3.fromRGB(50,120,200)
    setBtn.MouseButton1Click:Connect(function() updateBase(); Rayfield:Notify({Title="Base Set",Content=tostring(Config.basePosition),Duration=2}) end)
    -- Go Button
    local goBtn=Instance.new("TextButton",content)
    goBtn.Size,goBtn.Position = UDim2.new(0,120,0,35),UDim2.new(0.55,0,0.1,0)
    goBtn.Text,goBtn.Font,goBtn.TextSize,goBtn.TextColor3 = "🚀 Go To Base",Enum.Font.GothamBold,14,Color3.new(1,1,1)
    goBtn.BackgroundTransparency,goBtn.BackgroundColor3=0.1,Color3.fromRGB(100,200,120)
    goBtn.MouseButton1Click:Connect(function() teleportTo(Config.basePosition) end)
end

local function createSkyGui()
    if globalGUI.SkyGui then globalGUI.SkyGui:Destroy() end
    local gui,content= createMinimizableGui("🌤 Sky Control")
    globalGUI.SkyGui = gui
    local upBtn=Instance.new("TextButton",content)
    upBtn.Size,upBtn.Position,upBtn.Text = UDim2.new(0,100,0,35),UDim2.new(0.1,0,0.1,0),"🚀 UP"
    upBtn.Font,upBtn.TextSize = Enum.Font.GothamBold,14
    upBtn.MouseButton1Click:Connect(teleportUp)
    local downBtn=Instance.new("TextButton",content)
    downBtn.Size,downBtn.Position,downBtn.Text = UDim2.new(0,100,0,35),UDim2.new(0.6,0,0.1,0),"⬇️ DOWN"
    downBtn.Font,downBtn.TextSize = Enum.Font.GothamBold,14
    downBtn.MouseButton1Click:Connect(teleportDown)
end

local function createLeaveGui()
    if globalGUI.LeaveGui then globalGUI.LeaveGui:Destroy() end
    local gui,content= createMinimizableGui("🚪 Leave & Hop")
    globalGUI.LeaveGui=gui
    local leaveBtn=Instance.new("TextButton",content)
    leaveBtn.Size,leaveBtn.Position,leaveBtn.Text = UDim2.new(0,120,0,35),UDim2.new(0.1,0,0.1,0),"🚪 Leave Server"
    leaveBtn.Font,leaveBtn.TextSize = Enum.Font.GothamBold,14
    leaveBtn.MouseButton1Click:Connect(function() LocalPlayer:Kick("User left") end)
    local hopBtn=Instance.new("TextButton",content)
    hopBtn.Size,hopBtn.Position,hopBtn.Text = UDim2.new(0,120,0,35),UDim2.new(0.55,0,0.1,0),"🔄 Server Hop"
    hopBtn.Font,hopBtn.TextSize=Enum.Font.GothamBold,14
    hopBtn.MouseButton1Click:Connect(function() TeleportService:Teleport(game.PlaceId,LocalPlayer) end)
end

-- Initialize Rayfield Window & Tabs
local Window = Rayfield:CreateWindow({Name="Brainrot Hub Enhanced",LoadingTitle="Loading...",ConfigurationSaving={Enabled=false},Discord={Enabled=false},KeySystem=false})
local Main = Window:CreateTab("Main")
local Combat = Window:CreateTab("Steal/Combat")
local Other = Window:CreateTab("Other")

-- Main Tab
Main:CreateSection("Speed & Movement")
Main:CreateButton({Name="Speed Boost +45%",Callback=function()
    local char=LocalPlayer.Character
    if char and char:FindFirstChild("Humanoid") then char.Humanoid.WalkSpeed=Config.originalSpeed*1.45; Rayfield:Notify({Title="Speed",Content="Boosted",Duration=2}) end
end})
Main:CreateButton({Name="Natural Walk to Base",Callback=function() naturalWalk(); Rayfield:Notify({Title="Walk",Content="Moving",Duration=2}) end})
Main:CreateSection("Teleport")
Main:CreateButton({Name="Open Base GUI",Callback=createBaseGui})
Main:CreateButton({Name="Open Sky Widget",Callback=createSkyGui})

-- Combat Tab
Combat:CreateSection("Combat & Steal")
Combat:CreateToggle({Name="God Mode",Default=false,Callback=function(v) toggleGodMode(v); Rayfield:Notify({Title="GodMode",Content=v and "ON" or "OFF",Duration=2}) end})
Combat:CreateToggle({Name="Anti Ragdoll",Default=false,Callback=function(v) toggleAntiRagdoll(v); Rayfield:Notify({Title="AntiRagdoll",Content=v and "Enabled" or "Disabled",Duration=2}) end})
Combat:CreateToggle({Name="Enhanced Kill Aura",Default=false,Callback=function(v) if v then startKillAura() else stopKillAura() end; Rayfield:Notify({Title="KillAura",Content=v and "Active" or "Stopped",Duration=2}) end})
Combat:CreateButton({Name="Invisibility",Callback=function() local char=LocalPlayer.Character if char then for _,p in pairs(char:GetChildren())do if p:IsA("BasePart")then p.Transparency=p.Transparency==0 and 1 or 0 end end; Rayfield:Notify({Title="Invisibility",Content="Toggled",Duration=2}) end end})
Combat:CreateButton({Name="No Clip",Callback=function() local char=LocalPlayer.Character if char then for _,p in pairs(char:GetChildren())do if p:IsA("BasePart")then p.CanCollide=not p.CanCollide end end; Rayfield:Notify({Title="NoClip",Content="Toggled",Duration=2}) end end})
Combat:CreateButton({Name="Leave GUI",Callback=createLeaveGui})

-- Other Tab
Other:CreateSection("Additional Tools")
Other:CreateButton({Name="Reset Character",Callback=function() if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then LocalPlayer.Character.Humanoid.Health=0 end; Rayfield:Notify({Title="Reset",Content="Done",Duration=2}) end})
Other:CreateButton({Name="Rejoin Game",Callback=function() TeleportService:Teleport(game.PlaceId,LocalPlayer) end})
Other:CreateSlider({Name="FOV Changer",Min=10,Max=120,Default=70,Increment=1,Callback=function(v)workspace.CurrentCamera.FieldOfView=v end})

-- Final Notification
Rayfield:Notify({Title="Loaded",Content="Brainrot Hub Enhanced Complete",Duration=3})
