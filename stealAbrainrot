-- Brainrot Universal Script with Enhanced Features
-- Multiple Rayfield loading methods
local Rayfield
pcall(function()
    Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()
end)

if not Rayfield then
    pcall(function()
        Rayfield = loadstring(game:HttpGet('https://raw.githubusercontent.com/shlexware/Rayfield/main/source'))()
    end)
end

if not Rayfield then return end

-- Wait for game
repeat wait(0.1) until game:IsLoaded()

-- Services
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local TeleportService = game:GetService("TeleportService")
local LocalPlayer = Players.LocalPlayer

-- Variables
local basePosition = Vector3.new(0, 10, 0)
local originalSpeed = 16
local godMode = false
local antiRagdoll = false
local autoWalk = false
local skyWidget = nil
local skyWidgetVisible = false
local skyWidgetMinimized = false
local leaveGui = nil
local baseGui = nil
local killAuraActive = false
local killAuraConnection = nil
local intentionalKick = false
local flyEnabled = false
local flyConnection = nil

-- Anti-kick system
local function antiKick()
    local mt = getrawmetatable(game)
    local old = mt.__namecall
    setreadonly(mt, false)
    mt.__namecall = newcclosure(function(self, ...)
        local method = getnamecallmethod()
        if method == "Kick" and not intentionalKick then
            return
        end
        return old(self, ...)
    end)
    setreadonly(mt, true)
end

-- Natural walk teleport (115% speed for bypass)
local function naturalWalk(targetPosition)
    local char = LocalPlayer.Character
    if not char or not char:FindFirstChild("HumanoidRootPart") then return end
    
    local hrp = char.HumanoidRootPart
    local humanoid = char.Humanoid
    local startPos = hrp.Position
    local distance = (startPos - targetPosition).Magnitude
    
    -- Calculate time for 115% normal walk speed (faster for bypass)
    local walkTime = distance / (originalSpeed * 1.15)
    
    -- Create smooth tween
    local tweenInfo = TweenInfo.new(
        walkTime,
        Enum.EasingStyle.Linear,
        Enum.EasingDirection.InOut
    )
    
    local tween = TweenService:Create(hrp, tweenInfo, {CFrame = CFrame.new(targetPosition)})
    tween:Play()
end

-- Teleport Up function
local function teleportUp()
    pcall(function()
        local char = LocalPlayer.Character
        if char and char:FindFirstChild("HumanoidRootPart") then
            local pos = char.HumanoidRootPart.Position
            char.HumanoidRootPart.CFrame = CFrame.new(pos + Vector3.new(0, 265, 0))
        end
    end)
end

-- Teleport Down function
local function teleportDown()
    pcall(function()
        local char = LocalPlayer.Character
        if char and char:FindFirstChild("HumanoidRootPart") then
            local pos = char.HumanoidRootPart.Position
            char.HumanoidRootPart.CFrame = CFrame.new(pos - Vector3.new(0, 50, 0))
        end
    end)
end

-- Enhanced Kill Aura with 360-degree detection
local function startKillAura()
    if killAuraActive then return end
    killAuraActive = true
    
    killAuraConnection = RunService.Heartbeat:Connect(function()
        pcall(function()
            local char = LocalPlayer.Character
            if not char or not char:FindFirstChild("HumanoidRootPart") then return end
            
            local tool = LocalPlayer.Backpack:FindFirstChildOfClass("Tool")
            if not tool then
                tool = char:FindFirstChildOfClass("Tool")
            end
            
            if tool then
                local nearbyPlayers = {}
                
                -- Find all nearby players
                for _, player in pairs(Players:GetPlayers()) do
                    if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                        local distance = (player.Character.HumanoidRootPart.Position - char.HumanoidRootPart.Position).Magnitude
                        if distance < 20 then -- Increased range for 360 coverage
                            table.insert(nearbyPlayers, {player = player, distance = distance})
                        end
                    end
                end
                
                -- Sort by distance (closest first)
                table.sort(nearbyPlayers, function(a, b)
                    return a.distance < b.distance
                end)
                
                -- Attack closest players (up to 3 at once for multi-directional coverage)
                for i = 1, math.min(#nearbyPlayers, 3) do
                    local targetPlayer = nearbyPlayers[i].player
                    local targetChar = targetPlayer.Character
                    
                    if targetChar and targetChar:FindFirstChild("HumanoidRootPart") then
                        -- Calculate direction vectors for 360-degree coverage
                        local targetDirection = (targetChar.HumanoidRootPart.Position - char.HumanoidRootPart.Position).Unit
                        
                        -- Rotate character to face target for better hit detection
                        local lookDirection = Vector3.new(targetDirection.X, 0, targetDirection.Z)
                        char.HumanoidRootPart.CFrame = CFrame.lookAt(char.HumanoidRootPart.Position, char.HumanoidRootPart.Position + lookDirection)
                        
                        -- Equip and activate tool
                        if tool.Parent == LocalPlayer.Backpack then
                            char.Humanoid:EquipTool(tool)
                        end
                        
                        if tool:FindFirstChild("Handle") then
                            tool:Activate()
                        end
                        
                        -- Small delay between attacks
                        wait(0.05)
                    end
                end
            end
        end)
    end)
end

local function stopKillAura()
    if killAuraConnection then
        killAuraConnection:Disconnect()
        killAuraConnection = nil
    end
    killAuraActive = false
end

-- Create Leave GUI (pulsanti verticali)
local function createLeaveGui()
    if leaveGui then
        leaveGui:Destroy()
    end
    
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "LeaveGui"
    screenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")
    screenGui.ResetOnSpawn = false
    leaveGui = screenGui
    
    -- Main Frame - Stile compatto
    local mainFrame = Instance.new("Frame")
    mainFrame.Name = "MainFrame"
    mainFrame.Size = UDim2.new(0, 200, 0, 150)
    mainFrame.Position = UDim2.new(0.5, -100, 0.5, -75)
    mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 45)
    mainFrame.BackgroundTransparency = 0.1
    mainFrame.BorderSizePixel = 0
    mainFrame.Parent = screenGui
    mainFrame.Active = true
    mainFrame.Draggable = true
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 12)
    corner.Parent = mainFrame
    
    -- Header
    local header = Instance.new("Frame")
    header.Name = "Header"
    header.Size = UDim2.new(1, 0, 0, 30)
    header.Position = UDim2.new(0, 0, 0, 0)
    header.BackgroundColor3 = Color3.fromRGB(50, 20, 30)
    header.BackgroundTransparency = 0.2
    header.BorderSizePixel = 0
    header.Parent = mainFrame
    
    local headerCorner = Instance.new("UICorner")
    headerCorner.CornerRadius = UDim.new(0, 12)
    headerCorner.Parent = header
    
    -- Title
    local title = Instance.new("TextLabel")
    title.Name = "Title"
    title.Size = UDim2.new(1, -60, 1, 0)
    title.Position = UDim2.new(0, 10, 0, 0)
    title.BackgroundTransparency = 1
    title.Text = "SERVER OPTIONS"
    title.TextColor3 = Color3.fromRGB(255, 255, 255)
    title.TextSize = 14
    title.Font = Enum.Font.GothamBold
    title.Parent = header
    
    -- Minimize Button
    local minimizeButton = Instance.new("TextButton")
    minimizeButton.Name = "MinimizeButton"
    minimizeButton.Size = UDim2.new(0, 20, 0, 20)
    minimizeButton.Position = UDim2.new(1, -50, 0.5, -10)
    minimizeButton.BackgroundColor3 = Color3.fromRGB(255, 180, 40)
    minimizeButton.Text = "-"
    minimizeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    minimizeButton.TextSize = 14
    minimizeButton.Font = Enum.Font.GothamBold
    minimizeButton.BorderSizePixel = 0
    minimizeButton.Parent = header
    
    local minimizeCorner = Instance.new("UICorner")
    minimizeCorner.CornerRadius = UDim.new(0, 10)
    minimizeCorner.Parent = minimizeButton
    
    -- Close Button
    local closeButton = Instance.new("TextButton")
    closeButton.Name = "CloseButton"
    closeButton.Size = UDim2.new(0, 20, 0, 20)
    closeButton.Position = UDim2.new(1, -25, 0.5, -10)
    closeButton.BackgroundColor3 = Color3.fromRGB(220, 60, 60)
    closeButton.Text = "✕"
    closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    closeButton.TextSize = 14
    closeButton.Font = Enum.Font.GothamBold
    closeButton.BorderSizePixel = 0
    closeButton.Parent = header
    
    local closeCorner = Instance.new("UICorner")
    closeCorner.CornerRadius = UDim.new(0, 10)
    closeCorner.Parent = closeButton
    
    -- Content Frame
    local contentFrame = Instance.new("Frame")
    contentFrame.Name = "ContentFrame"
    contentFrame.Size = UDim2.new(1, 0, 1, -30)
    contentFrame.Position = UDim2.new(0, 0, 0, 30)
    contentFrame.BackgroundTransparency = 1
    contentFrame.Parent = mainFrame
    
    -- Leave Button
    local leaveButton = Instance.new("TextButton")
    leaveButton.Name = "LeaveButton"
    leaveButton.Size = UDim2.new(0, 180, 0, 30)
    leaveButton.Position = UDim2.new(0.5, -90, 0, 20)
    leaveButton.BackgroundColor3 = Color3.fromRGB(200, 70, 70)
    leaveButton.Text = "🚪 LEAVE GAME"
    leaveButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    leaveButton.TextSize = 14
    leaveButton.Font = Enum.Font.GothamBold
    leaveButton.BorderSizePixel = 0
    leaveButton.Parent = contentFrame
    
    local leaveCorner = Instance.new("UICorner")
    leaveCorner.CornerRadius = UDim.new(0, 8)
    leaveCorner.Parent = leaveButton
    
    -- Server Hop Button
    local hopButton = Instance.new("TextButton")
    hopButton.Name = "HopButton"
    hopButton.Size = UDim2.new(0, 180, 0, 30)
    hopButton.Position = UDim2.new(0.5, -90, 0, 60)
    hopButton.BackgroundColor3 = Color3.fromRGB(70, 120, 200)
    hopButton.Text = "🔄 SERVER HOP"
    hopButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    hopButton.TextSize = 14
    hopButton.Font = Enum.Font.GothamBold
    hopButton.BorderSizePixel = 0
    hopButton.Parent = contentFrame
    
    local hopCorner = Instance.new("UICorner")
    hopCorner.CornerRadius = UDim.new(0, 8)
    hopCorner.Parent = hopButton
    
    -- Minimize functionality
    local function toggleMinimize()
        if contentFrame.Visible then
            contentFrame.Visible = false
            mainFrame.Size = UDim2.new(0, 200, 0, 30)
            minimizeButton.Text = "+"
        else
            contentFrame.Visible = true
            mainFrame.Size = UDim2.new(0, 200, 0, 150)
            minimizeButton.Text = "-"
        end
    end
    
    -- Button connections
    minimizeButton.MouseButton1Click:Connect(toggleMinimize)
    
    closeButton.MouseButton1Click:Connect(function()
        leaveGui:Destroy()
        leaveGui = nil
    end)
    
    leaveButton.MouseButton1Click:Connect(function()
        intentionalKick = true
        LocalPlayer:Kick("Left the game")
    end)
    
    hopButton.MouseButton1Click:Connect(function()
        pcall(function()
            TeleportService:Teleport(game.PlaceId, LocalPlayer)
        end)
    end)
end

-- Create Base GUI (pulsanti verticali e volo a mezz'aria)
local function createBaseGui()
    if baseGui then
        baseGui:Destroy()
    end
    
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "BaseGui"
    screenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")
    screenGui.ResetOnSpawn = false
    baseGui = screenGui
    
    -- Main Frame - Stile compatto
    local mainFrame = Instance.new("Frame")
    mainFrame.Name = "MainFrame"
    mainFrame.Size = UDim2.new(0, 220, 0, 230)
    mainFrame.Position = UDim2.new(0.5, -110, 0.5, -115)
    mainFrame.BackgroundColor3 = Color3.fromRGB(30, 35, 45)
    mainFrame.BackgroundTransparency = 0.1
    mainFrame.BorderSizePixel = 0
    mainFrame.Parent = screenGui
    mainFrame.Active = true
    mainFrame.Draggable = true
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 12)
    corner.Parent = mainFrame
    
    -- Header
    local header = Instance.new("Frame")
    header.Name = "Header"
    header.Size = UDim2.new(1, 0, 0, 30)
    header.Position = UDim2.new(0, 0, 0, 0)
    header.BackgroundColor3 = Color3.fromRGB(40, 45, 70)
    header.BackgroundTransparency = 0.2
    header.BorderSizePixel = 0
    header.Parent = mainFrame
    
    local headerCorner = Instance.new("UICorner")
    headerCorner.CornerRadius = UDim.new(0, 12)
    headerCorner.Parent = header
    
    -- Title
    local title = Instance.new("TextLabel")
    title.Name = "Title"
    title.Size = UDim2.new(1, -60, 1, 0)
    title.Position = UDim2.new(0, 10, 0, 0)
    title.BackgroundTransparency = 1
    title.Text = "BASE CONTROL"
    title.TextColor3 = Color3.fromRGB(255, 255, 255)
    title.TextSize = 14
    title.Font = Enum.Font.GothamBold
    title.Parent = header
    
    -- Minimize Button
    local minimizeButton = Instance.new("TextButton")
    minimizeButton.Name = "MinimizeButton"
    minimizeButton.Size = UDim2.new(0, 20, 0, 20)
    minimizeButton.Position = UDim2.new(1, -50, 0.5, -10)
    minimizeButton.BackgroundColor3 = Color3.fromRGB(255, 180, 40)
    minimizeButton.Text = "-"
    minimizeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    minimizeButton.TextSize = 14
    minimizeButton.Font = Enum.Font.GothamBold
    minimizeButton.BorderSizePixel = 0
    minimizeButton.Parent = header
    
    local minimizeCorner = Instance.new("UICorner")
    minimizeCorner.CornerRadius = UDim.new(0, 10)
    minimizeCorner.Parent = minimizeButton
    
    -- Close Button
    local closeButton = Instance.new("TextButton")
    closeButton.Name = "CloseButton"
    closeButton.Size = UDim2.new(0, 20, 0, 20)
    closeButton.Position = UDim2.new(1, -25, 0.5, -10)
    closeButton.BackgroundColor3 = Color3.fromRGB(220, 60, 60)
    closeButton.Text = "✕"
    closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    closeButton.TextSize = 14
    closeButton.Font = Enum.Font.GothamBold
    closeButton.BorderSizePixel = 0
    closeButton.Parent = header
    
    local closeCorner = Instance.new("UICorner")
    closeCorner.CornerRadius = UDim.new(0, 10)
    closeCorner.Parent = closeButton
    
    -- Content Frame
    local contentFrame = Instance.new("Frame")
    contentFrame.Name = "ContentFrame"
    contentFrame.Size = UDim2.new(1, 0, 1, -30)
    contentFrame.Position = UDim2.new(0, 0, 0, 30)
    contentFrame.BackgroundTransparency = 1
    contentFrame.Parent = mainFrame
    
    -- Input Box
    local inputBox = Instance.new("TextBox")
    inputBox.Name = "InputBox"
    inputBox.Size = UDim2.new(0, 200, 0, 25)
    inputBox.Position = UDim2.new(0.5, -100, 0, 10)
    inputBox.BackgroundColor3 = Color3.fromRGB(40, 40, 55)
    inputBox.Text = "0,10,0"
    inputBox.TextColor3 = Color3.fromRGB(255, 255, 255)
    inputBox.TextSize = 12
    inputBox.Font = Enum.Font.Gotham
    inputBox.PlaceholderText = "X,Y,Z"
    inputBox.BorderSizePixel = 0
    inputBox.Parent = contentFrame
    
    local inputCorner = Instance.new("UICorner")
    inputCorner.CornerRadius = UDim.new(0, 6)
    inputCorner.Parent = inputBox
    
    -- Set Position Button
    local setPositionButton = Instance.new("TextButton")
    setPositionButton.Name = "SetPositionButton"
    setPositionButton.Size = UDim2.new(0, 200, 0, 25)
    setPositionButton.Position = UDim2.new(0.5, -100, 0, 40)
    setPositionButton.BackgroundColor3 = Color3.fromRGB(120, 80, 200)
    setPositionButton.Text = "📍 SET CURRENT POSITION"
    setPositionButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    setPositionButton.TextSize = 12
    setPositionButton.Font = Enum.Font.GothamBold
    setPositionButton.BorderSizePixel = 0
    setPositionButton.Parent = contentFrame
    
    local setPositionCorner = Instance.new("UICorner")
    setPositionCorner.CornerRadius = UDim.new(0, 6)
    setPositionCorner.Parent = setPositionButton
    
    -- Set Base Button
    local setButton = Instance.new("TextButton")
    setButton.Name = "SetButton"
    setButton.Size = UDim2.new(0, 200, 0, 25)
    setButton.Position = UDim2.new(0.5, -100, 0, 70)
    setButton.BackgroundColor3 = Color3.fromRGB(80, 120, 200)
    setButton.Text = "📍 SET BASE"
    setButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    setButton.TextSize = 12
    setButton.Font = Enum.Font.GothamBold
    setButton.BorderSizePixel = 0
    setButton.Parent = contentFrame
    
    local setCorner = Instance.new("UICorner")
    setCorner.CornerRadius = UDim.new(0, 6)
    setCorner.Parent = setButton
    
    -- Go to Base Button (con volo a mezz'aria)
    local goButton = Instance.new("TextButton")
    goButton.Name = "GoButton"
    goButton.Size = UDim2.new(0, 200, 0, 25)
    goButton.Position = UDim2.new(0.5, -100, 0, 100)
    goButton.BackgroundColor3 = Color3.fromRGB(80, 180, 120)
    goButton.Text = "🚀 GO TO BASE (FLY)"
    goButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    goButton.TextSize = 12
    goButton.Font = Enum.Font.GothamBold
    goButton.BorderSizePixel = 0
    goButton.Parent = contentFrame
    
    local goCorner = Instance.new("UICorner")
    goCorner.CornerRadius = UDim.new(0, 6)
    goCorner.Parent = goButton
    
    -- Info label
    local infoLabel = Instance.new("TextLabel")
    infoLabel.Name = "InfoLabel"
    infoLabel.Size = UDim2.new(1, -20, 0, 15)
    infoLabel.Position = UDim2.new(0, 10, 0, 130)
    infoLabel.BackgroundTransparency = 1
    infoLabel.Text = "Teleport con volo a mezz'aria"
    infoLabel.TextColor3 = Color3.fromRGB(180, 180, 180)
    infoLabel.TextSize = 10
    infoLabel.Font = Enum.Font.Gotham
    infoLabel.Parent = contentFrame
    
    -- Minimize functionality
    local function toggleMinimize()
        if contentFrame.Visible then
            contentFrame.Visible = false
            mainFrame.Size = UDim2.new(0, 220, 0, 30)
            minimizeButton.Text = "+"
        else
            contentFrame.Visible = true
            mainFrame.Size = UDim2.new(0, 220, 0, 230)
            minimizeButton.Text = "-"
        end
    end
    
    -- Button connections
    minimizeButton.MouseButton1Click:Connect(toggleMinimize)
    
    closeButton.MouseButton1Click:Connect(function()
        baseGui:Destroy()
        baseGui = nil
    end)
    
    setPositionButton.MouseButton1Click:Connect(function()
        pcall(function()
            local char = LocalPlayer.Character
            if char and char:FindFirstChild("HumanoidRootPart") then
                local pos = char.HumanoidRootPart.Position
                basePosition = pos
                inputBox.Text = string.format("%.1f,%.1f,%.1f", pos.X, pos.Y, pos.Z)
                
                Rayfield:Notify({
                    Title = "Position Set",
                    Content = "Current position saved as base",
                    Duration = 1.5,
                    Image = 4483362458
                })
            end
        end)
    end)
    
    setButton.MouseButton1Click:Connect(function()
        pcall(function()
            local text = inputBox.Text
            local coords = string.split(text, ",")
            if #coords == 3 then
                local x, y, z = tonumber(coords[1]), tonumber(coords[2]), tonumber(coords[3])
                if x and y and z then
                    basePosition = Vector3.new(x, y, z)
                    Rayfield:Notify({
                        Title = "Base Set",
                        Content = "New base position set to " .. text,
                        Duration = 1.5,
                        Image = 4483362458
                    })
                end
            end
        end)
    end)
    
    -- Funzione per volare a mezz'aria
    local function flyToBase()
        pcall(function()
            local char = LocalPlayer.Character
            if char and char:FindFirstChild("HumanoidRootPart") then
                local hrp = char.HumanoidRootPart
                
                -- Calcola l'altezza di volo (100 unità sopra la base)
                local flyHeight = basePosition.Y + 100
                
                -- Imposta la posizione di volo
                local flyPosition = Vector3.new(basePosition.X, flyHeight, basePosition.Z)
                
                -- Teleport rapido alla posizione di volo
                hrp.CFrame = CFrame.new(flyPosition)
                
                -- Attiva il fly mode per rimanere in aria
                if flyConnection then
                    flyConnection:Disconnect()
                    flyConnection = nil
                end
                
                flyConnection = RunService.Heartbeat:Connect(function()
                    if char and hrp then
                        -- Mantieni il player a mezz'aria
                        local currentPos = hrp.Position
                        hrp.CFrame = CFrame.new(Vector3.new(currentPos.X, flyHeight, currentPos.Z))
                        
                        -- Aggiungi un effetto di fluttuazione
                        hrp.Velocity = Vector3.new(0, 0, 0)
                        hrp.RotVelocity = Vector3.new(0, 0, 0)
                    else
                        if flyConnection then
                            flyConnection:Disconnect()
                            flyConnection = nil
                        end
                    end
                end)
                
                Rayfield:Notify({
                    Title = "Base Flight",
                    Content = "Volo a mezz'aria attivato!",
                    Duration = 2,
                    Image = 4483362458
                })
            end
        end)
    end
    
    goButton.MouseButton1Click:Connect(flyToBase)
end

-- Create Sky Widget (pulsanti verticali)
local function createSkyWidget()
    if skyWidget then
        skyWidget:Destroy()
    end
    
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "SkyWidget"
    screenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")
    screenGui.ResetOnSpawn = false
    skyWidget = screenGui
    
    -- Main Frame
    local mainFrame = Instance.new("Frame")
    mainFrame.Name = "MainFrame"
    mainFrame.Size = UDim2.new(0, 180, 0, 150)
    mainFrame.Position = UDim2.new(0.5, -90, 0.3, -75)
    mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 45)
    mainFrame.BackgroundTransparency = 0.1
    mainFrame.BorderSizePixel = 0
    mainFrame.Parent = screenGui
    mainFrame.Active = true
    mainFrame.Draggable = true
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 12)
    corner.Parent = mainFrame
    
    -- Header
    local header = Instance.new("Frame")
    header.Name = "Header"
    header.Size = UDim2.new(1, 0, 0, 30)
    header.Position = UDim2.new(0, 0, 0, 0)
    header.BackgroundColor3 = Color3.fromRGB(45, 30, 60)
    header.BackgroundTransparency = 0.2
    header.BorderSizePixel = 0
    header.Parent = mainFrame
    
    local headerCorner = Instance.new("UICorner")
    headerCorner.CornerRadius = UDim.new(0, 12)
    headerCorner.Parent = header
    
    -- Title
    local title = Instance.new("TextLabel")
    title.Name = "Title"
    title.Size = UDim2.new(1, -60, 1, 0)
    title.Position = UDim2.new(0, 10, 0, 0)
    title.BackgroundTransparency = 1
    title.Text = "SKY CONTROL"
    title.TextColor3 = Color3.fromRGB(255, 255, 255)
    title.TextSize = 14
    title.Font = Enum.Font.GothamBold
    title.Parent = header
    
    -- Minimize Button
    local minimizeButton = Instance.new("TextButton")
    minimizeButton.Name = "MinimizeButton"
    minimizeButton.Size = UDim2.new(0, 20, 0, 20)
    minimizeButton.Position = UDim2.new(1, -50, 0.5, -10)
    minimizeButton.BackgroundColor3 = Color3.fromRGB(255, 180, 40)
    minimizeButton.Text = "-"
    minimizeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    minimizeButton.TextSize = 14
    minimizeButton.Font = Enum.Font.GothamBold
    minimizeButton.BorderSizePixel = 0
    minimizeButton.Parent = header
    
    local minimizeCorner = Instance.new("UICorner")
    minimizeCorner.CornerRadius = UDim.new(0, 10)
    minimizeCorner.Parent = minimizeButton
    
    -- Close Button
    local closeButton = Instance.new("TextButton")
    closeButton.Name = "CloseButton"
    closeButton.Size = UDim2.new(0, 20, 0, 20)
    closeButton.Position = UDim2.new(1, -25, 0.5, -10)
    closeButton.BackgroundColor3 = Color3.fromRGB(220, 60, 60)
    closeButton.Text = "✕"
    closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    closeButton.TextSize = 14
    closeButton.Font = Enum.Font.GothamBold
    closeButton.BorderSizePixel = 0
    closeButton.Parent = header
    
    local closeCorner = Instance.new("UICorner")
    closeCorner.CornerRadius = UDim.new(0, 10)
    closeCorner.Parent = closeButton
    
    -- Content Frame
    local contentFrame = Instance.new("Frame")
    contentFrame.Name = "ContentFrame"
    contentFrame.Size = UDim2.new(1, 0, 1, -30)
    contentFrame.Position = UDim2.new(0, 0, 0, 30)
    contentFrame.BackgroundTransparency = 1
    contentFrame.Parent = mainFrame
    
    -- Up Button
    local upButton = Instance.new("TextButton")
    upButton.Name = "UpButton"
    upButton.Size = UDim2.new(0, 160, 0, 30)
    upButton.Position = UDim2.new(0.5, -80, 0, 20)
    upButton.BackgroundColor3 = Color3.fromRGB(60, 180, 100)
    upButton.Text = "↑ UP ↑"
    upButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    upButton.TextSize = 14
    upButton.Font = Enum.Font.GothamBold
    upButton.BorderSizePixel = 0
    upButton.Parent = contentFrame
    
    local upCorner = Instance.new("UICorner")
    upCorner.CornerRadius = UDim.new(0, 8)
    upCorner.Parent = upButton
    
    -- Down Button
    local downButton = Instance.new("TextButton")
    downButton.Name = "DownButton"
    downButton.Size = UDim2.new(0, 160, 0, 30)
    downButton.Position = UDim2.new(0.5, -80, 0, 60)
    downButton.BackgroundColor3 = Color3.fromRGB(180, 80, 80)
    downButton.Text = "↓ DOWN ↓"
    downButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    downButton.TextSize = 14
    downButton.Font = Enum.Font.GothamBold
    downButton.BorderSizePixel = 0
    downButton.Parent = contentFrame
    
    local downCorner = Instance.new("UICorner")
    downCorner.CornerRadius = UDim.new(0, 8)
    downCorner.Parent = downButton
    
    -- Minimize functionality
    local function toggleMinimize()
        skyWidgetMinimized = not skyWidgetMinimized
        if skyWidgetMinimized then
            contentFrame.Visible = false
            mainFrame.Size = UDim2.new(0, 180, 0, 30)
            minimizeButton.Text = "+"
        else
            contentFrame.Visible = true
            mainFrame.Size = UDim2.new(0, 180, 0, 150)
            minimizeButton.Text = "-"
        end
    end
    
    -- Button connections
    minimizeButton.MouseButton1Click:Connect(toggleMinimize)
    
    closeButton.MouseButton1Click:Connect(function()
        skyWidget:Destroy()
        skyWidget = nil
        skyWidgetVisible = false
    end)
    
    upButton.MouseButton1Click:Connect(teleportUp)
    downButton.MouseButton1Click:Connect(teleportDown)
    
    skyWidgetVisible = true
end

-- God mode function
local function toggleGodMode()
    godMode = not godMode
    local char = LocalPlayer.Character
    if not char then return end
    
    if godMode then
        for _, part in pairs(char:GetChildren()) do
            if part:IsA("BasePart") then
                part.CanCollide = false
            end
        end
        if char:FindFirstChild("Humanoid") then
            char.Humanoid.MaxHealth = math.huge
            char.Humanoid.Health = math.huge
        end
    else
        for _, part in pairs(char:GetChildren()) do
            if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
                part.CanCollide = true
            end
        end
        if char:FindFirstChild("Humanoid") then
            char.Humanoid.MaxHealth = 100
            char.Humanoid.Health = 100
        end
    end
end

-- Character setup
local function setupCharacter()
    repeat wait(0.1) until LocalPlayer.Character
    repeat wait(0.1) until LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
    basePosition = LocalPlayer.Character.HumanoidRootPart.Position
end

if LocalPlayer.Character then
    setupCharacter()
end
LocalPlayer.CharacterAdded:Connect(setupCharacter)

-- Initialize anti-kick
pcall(antiKick)

-- Create UI
local Window = Rayfield:CreateWindow({
    Name = "Brainrot Hub Pro",
    LoadingTitle = "Loading Pro Version...",
    LoadingSubtitle = "Admin tools for everyone",
    ConfigurationSaving = {Enabled = false},
    Discord = {Enabled = false},
    KeySystem = false
})

local Tab = Window:CreateTab("Main", 4483362458)
local StealTab = Window:CreateTab("Steal/Combat", 4483362458)
local OtherTab = Window:CreateTab("Other", 4483362458)

-- Speed Section
Tab:CreateSection("Speed & Movement")

Tab:CreateButton({
    Name = "Speed Boost +45%",
    Callback = function()
        pcall(function()
            local char = LocalPlayer.Character
            if char and char:FindFirstChild("Humanoid") then
                char.Humanoid.WalkSpeed = originalSpeed * 1.45
                Rayfield:Notify({
                    Title = "Speed Boost",
                    Content = "Speed activated",
                    Duration = 1.5,
                    Image = 4483362458
                })
            end
        end)
    end
})

Tab:CreateButton({
    Name = "Natural Walk to Base",
    Callback = function()
        pcall(function()
            naturalWalk(basePosition)
            Rayfield:Notify({
                Title = "Natural Walk",
                Content = "Walking to base...",
                Duration = 1.5,
                Image = 4483362458
                })
        end)
    end
})

-- Teleport Section
Tab:CreateSection("Teleport")

Tab:CreateInput({
    Name = "Set Base (X,Y,Z)",
    PlaceholderText = "0,10,0",
    RemoveTextAfterFocusLost = false,
    Callback = function(text)
        pcall(function()
            local coords = string.split(text, ",")
            if #coords == 3 then
                local x, y, z = tonumber(coords[1]), tonumber(coords[2]), tonumber(coords[3])
                if x and y and z then
                    basePosition = Vector3.new(x, y, z)
                    Rayfield:Notify({
                        Title = "Base Set",
                        Content = "New base position set",
                        Duration = 1.5,
                        Image = 4483362458
                    })
                end
            end
        end)
    end
})

Tab:CreateButton({
    Name = "Go Sky",
    Callback = function()
        pcall(function()
            if not skyWidgetVisible then
                createSkyWidget()
            end
        end)
    end
})

-- Steal/Combat Features
StealTab:CreateSection("Combat & Steal")

StealTab:CreateToggle({
    Name = "God Mode",
    Default = false,
    Callback = function(value)
        toggleGodMode()
        Rayfield:Notify({
            Title = "God Mode",
            Content = value and "ON" or "OFF",
            Duration = 1.5,
            Image = 4483362458
        })
    end
})

StealTab:CreateToggle({
    Name = "Kill Aura 360°",
    Default = false,
    Callback = function(value)
        pcall(function()
            if value then
                startKillAura()
                Rayfield:Notify({
                    Title = "Kill Aura",
                    Content = "Activated",
                    Duration = 1.5,
                    Image = 4483362458
                })
            else
                stopKillAura()
                Rayfield:Notify({
                    Title = "Kill Aura",
                    Content = "Deactivated",
                    Duration = 1.5,
                    Image = 4483362458
                })
            end
        end)
    end
})

StealTab:CreateButton({
    Name = "Invisibility",
    Callback = function()
        pcall(function()
            local char = LocalPlayer.Character
            if char then
                for _, part in pairs(char:GetChildren()) do
                    if part:IsA("BasePart") then
                        part.Transparency = part.Transparency == 0 and 1 or 0
                    end
                end
                Rayfield:Notify({
                    Title = "Invisibility",
                    Content = "Toggled",
                    Duration = 1.5,
                    Image = 4483362458
                })
            end
        end)
    end
})

StealTab:CreateButton({
    Name = "Leave GUI",
    Callback = function()
        pcall(function()
            createLeaveGui()
        end)
    end
})

-- Other Tab Features
OtherTab:CreateSection("Additional Tools")

OtherTab:CreateButton({
    Name = "Open Base GUI",
    Callback = function()
        pcall(function()
            createBaseGui()
        end)
    end
})

OtherTab:CreateButton({
    Name = "Reset Character",
    Callback = function()
        pcall(function()
            LocalPlayer.Character:FindFirstChild("Humanoid").Health = 0
            Rayfield:Notify({
                Title = "Reset",
                Content = "Character reset",
                Duration = 1.5,
                Image = 4483362458
            })
        end)
    end
})

OtherTab:CreateButton({
    Name = "Rejoin Game",
    Callback = function()
        pcall(function()
            TeleportService:Teleport(game.PlaceId, LocalPlayer)
        end)
    end
})

-- Success notification
Rayfield:Notify({
    Title = "Brainrot Hub Pro Loaded",
    Content = "All features activated!",
    Duration = 3,
    Image = 4483362458
})
